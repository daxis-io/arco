Delta-primary cutover verification evidence
Generated (UTC): 2026-02-19T04:17:21Z
Worktree: /Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover

============================================================
Date (UTC): 2026-02-19T04:17:41Z
Command: cargo test -p arco-core --test table_format_contracts
------------------------------------------------------------
   Compiling arco-core v0.1.0 (/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/crates/arco-core)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 3.11s
     Running tests/table_format_contracts.rs (target/debug/deps/table_format_contracts-b1788529cc3bac57)

running 4 tests
test canonical_strings_are_lowercase ... ok
test parse_rejects_unknown_values ... ok
test effective_format_uses_legacy_parquet_fallback ... ok
test parses_supported_formats_case_insensitively ... ok

test result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


Exit code: 0

============================================================
Date (UTC): 2026-02-19T04:18:35Z
Command: cargo fmt --all -- --check
------------------------------------------------------------

Exit code: 0

============================================================
Date (UTC): 2026-02-19T04:18:36Z
Command: cargo clippy --workspace --all-targets --all-features -- -D warnings
------------------------------------------------------------
    Checking arco-core v0.1.0 (/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/crates/arco-core)
    Checking datafusion-physical-expr-common v46.0.1
    Checking datafusion-functions-aggregate-common v46.0.1
    Checking datafusion-functions-window-common v46.0.1
    Checking datafusion-expr v46.0.1
    Checking arco-flow v0.1.0 (/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/crates/arco-flow)
    Checking arco-catalog v0.1.0 (/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/crates/arco-catalog)
    Checking arco-uc v0.1.0 (/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/crates/arco-uc)
    Checking arco-delta v0.1.0 (/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/crates/arco-delta)
error: variables can be used directly in the `format!` string
  --> crates/arco-core/examples/basic_usage.rs:11:5
   |
11 |     println!("Tenant: {}", tenant);
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
   = note: `-D clippy::uninlined-format-args` implied by `-D warnings`
   = help: to override `-D warnings` add `#[allow(clippy::uninlined_format_args)]`
help: change this to
   |
11 -     println!("Tenant: {}", tenant);
11 +     println!("Tenant: {tenant}");
   |

error: use of `println!`
  --> crates/arco-core/examples/basic_usage.rs:11:5
   |
11 |     println!("Tenant: {}", tenant);
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#print_stdout
   = note: `-D clippy::print-stdout` implied by `-D warnings`
   = help: to override `-D warnings` add `#[allow(clippy::print_stdout)]`

error: use of `println!`
  --> crates/arco-core/examples/basic_usage.rs:12:5
   |
12 |     println!("Storage prefix: {}", tenant.storage_prefix());
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#print_stdout

error: variables can be used directly in the `format!` string
  --> crates/arco-core/examples/basic_usage.rs:16:5
   |
16 |     println!("Asset ID: {}", asset_id);
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
   |
16 -     println!("Asset ID: {}", asset_id);
16 +     println!("Asset ID: {asset_id}");
   |

error: use of `println!`
  --> crates/arco-core/examples/basic_usage.rs:16:5
   |
16 |     println!("Asset ID: {}", asset_id);
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#print_stdout

error: could not compile `arco-core` (example "basic_usage") due to 5 previous errors
warning: build failed, waiting for other jobs to finish...
error: used `unwrap()` on a `Result` value
 --> crates/arco-core/tests/table_format_contracts.rs:7:16
  |
7 |     assert_eq!(TableFormat::parse("DELTA").unwrap(), TableFormat::Delta);
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
  = note: if this value is an `Err`, it will panic
  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used
  = note: requested on the command line with `-D clippy::unwrap-used`

error: used `unwrap()` on a `Result` value
 --> crates/arco-core/tests/flow_paths_contracts.rs:9:17
  |
9 |     let paths = DeltaPaths::new(table_id, "warehouse/sales/orders").unwrap();
  |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
  = note: if this value is an `Err`, it will panic
  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used
  = note: requested on the command line with `-D clippy::unwrap-used`

error: used `unwrap()` on a `Result` value
 --> crates/arco-core/tests/table_format_contracts.rs:8:16
  |
8 |     assert_eq!(TableFormat::parse("Iceberg").unwrap(), TableFormat::Iceberg);
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
  = note: if this value is an `Err`, it will panic
  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
 --> crates/arco-core/tests/table_format_contracts.rs:9:16
  |
9 |     assert_eq!(TableFormat::parse("parquet").unwrap(), TableFormat::Parquet);
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
  = note: if this value is an `Err`, it will panic
  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
  --> crates/arco-core/tests/table_format_contracts.rs:17:16
   |
17 |     assert_eq!(TableFormat::normalize("DeLtA").unwrap(), "delta");
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
  --> crates/arco-core/tests/table_format_contracts.rs:22:16
   |
22 |     assert_eq!(TableFormat::effective(None).unwrap(), TableFormat::Parquet);
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
  --> crates/arco-core/tests/flow_paths_contracts.rs:27:17
   |
27 |     let paths = DeltaPaths::new(Uuid::nil(), "warehouse/sales/orders").unwrap();
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
  --> crates/arco-core/tests/flow_paths_contracts.rs:29:9
   |
29 |         paths.delta_log_json(42).unwrap(),
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
  --> crates/arco-core/tests/table_format_contracts.rs:24:9
   |
24 |         TableFormat::effective(Some("ICEBERG")).unwrap(),
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
  --> crates/arco-core/tests/flow_paths_contracts.rs:37:17
   |
37 |       let paths = DeltaPaths::from_table_location(
   |  _________________^
38 | |         table_id,
39 | |         Some("gs://lake/tenant=acme/workspace=analytics/warehouse/sales/orders/"),
40 | |         "acme",
...  |
43 | |     .unwrap();
   | |_____________^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
  --> crates/arco-core/tests/flow_paths_contracts.rs:50:17
   |
50 |     let paths = DeltaPaths::from_table_location(table_id, None, "acme", "analytics").unwrap();
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
  --> crates/arco-core/tests/flow_paths_contracts.rs:56:17
   |
56 |     let paths = DeltaPaths::new(Uuid::nil(), "warehouse/sales/orders").unwrap();
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: could not compile `arco-core` (test "table_format_contracts") due to 6 previous errors
error: could not compile `arco-core` (test "flow_paths_contracts") due to 6 previous errors
error: indexing may panic
    --> crates/arco-core/src/audit.rs:1037:20
     |
1037 |         assert_eq!(captured[0].action, AuditAction::AuthAllow);
     |                    ^^^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing
     = note: `-D clippy::indexing-slicing` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::indexing_slicing)]`

error: indexing may panic
    --> crates/arco-core/src/audit.rs:1038:20
     |
1038 |         assert_eq!(captured[0].actor, "user:test");
     |                    ^^^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-core/src/audit.rs:1070:20
     |
1070 |         assert_eq!(allows[0].actor, "user:alice");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-core/src/audit.rs:1071:20
     |
1071 |         assert_eq!(denies[0].actor, "anonymous");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: item in documentation is missing backticks
 --> crates/arco-core/tests/cross_language/partition_key_test.rs:1:20
  |
1 | //! Cross-language PartitionKey canonical encoding tests.
  |                    ^^^^^^^^^^^^
  |
  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
  = note: `-D clippy::doc-markdown` implied by `-D warnings`
  = help: to override `-D warnings` add `#[allow(clippy::doc_markdown)]`
help: try
  |
1 | //! Cross-language `PartitionKey` canonical encoding tests.
  |                    ~~~~~~~~~~~~~~

error: could not compile `arco-core` (test "integration") due to 1 previous error
error: docs for function which may panic missing `# Panics` section
  --> crates/arco-delta/src/coordinator.rs:61:5
   |
61 |     pub fn new(storage: ScopedStorage, table_id: Uuid) -> Self {
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
note: first possible panic found here
  --> crates/arco-delta/src/coordinator.rs:63:21
   |
63 |         let paths = DeltaPaths::new(table_id, legacy_root).expect("legacy delta path is valid");
   |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#missing_panics_doc
   = note: `-D clippy::missing-panics-doc` implied by `-D warnings`
   = help: to override `-D warnings` add `#[allow(clippy::missing_panics_doc)]`

error: used `expect()` on a `Result` value
  --> crates/arco-delta/src/coordinator.rs:63:21
   |
63 |         let paths = DeltaPaths::new(table_id, legacy_root).expect("legacy delta path is valid");
   |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: if this value is an `Err`, it will panic
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used
   = note: requested on the command line with `-D clippy::expect-used`

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:650:21
    |
650 |           let guard = lock
    |  _____________________^
651 | |             .acquire(Duration::from_secs(30), 5)
652 | |             .await
653 | |             .expect("acquire");
    | |______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used
    = note: requested on the command line with `-D clippy::expect-used`

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:656:9
    |
656 |         guard.release().await.expect("release");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:659:18
    |
659 |         assert!(!lock.is_locked().await.expect("check"));
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:669:23
    |
669 |           let _guard1 = lock1
    |  _______________________^
670 | |             .acquire(Duration::from_secs(30), 1)
671 | |             .await
672 | |             .expect("acquire1");
    | |_______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:686:22
    |
686 |           let guard1 = lock1
    |  ______________________^
687 | |             .acquire(Duration::from_millis(1), 1)
688 | |             .await
689 | |             .expect("acquire1");
    | |_______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:698:22
    |
698 |           let guard2 = lock2
    |  ______________________^
699 | |             .acquire(Duration::from_secs(30), 1)
700 | |             .await
701 | |             .expect("acquire2");
    | |_______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:710:9
    |
710 |         guard2.release().await.expect("release2");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:719:22
    |
719 |           let guard1 = lock1
    |  ______________________^
720 | |             .acquire(Duration::from_millis(1), 1)
721 | |             .await
722 | |             .expect("acquire1");
    | |_______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:730:22
    |
730 |           let guard2 = lock2
    |  ______________________^
731 | |             .acquire(Duration::from_secs(1), 1)
732 | |             .await
733 | |             .expect("acquire2");
    | |_______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:737:9
    |
737 |         guard2.release().await.expect("release2");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:742:22
    |
742 |           let guard3 = lock3
    |  ______________________^
743 | |             .acquire(Duration::from_secs(30), 1)
744 | |             .await
745 | |             .expect("acquire3");
    | |_______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:750:9
    |
750 |         guard3.release().await.expect("release3");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:758:21
    |
758 |           let guard = lock
    |  _____________________^
759 | |             .acquire(Duration::from_secs(30), 1)
760 | |             .await
761 | |             .expect("acquire");
    | |______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:773:9
    |
773 |         guard.release().await.expect("release");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:799:22
    |
799 |           let _guard = lock
    |  ______________________^
800 | |             .acquire(Duration::from_secs(30), 1)
801 | |             .await
802 | |             .expect("acquire");
    | |______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:803:17
    |
803 |         assert!(lock.is_locked().await.expect("check"));
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:805:9
    |
805 |         lock.force_break().await.expect("break");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:806:18
    |
806 |         assert!(!lock.is_locked().await.expect("check2"));
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:814:21
    |
814 |           let guard = lock
    |  _____________________^
815 | |             .acquire_with_operation(Duration::from_secs(30), 5, Some("CreateAsset".into()))
816 | |             .await
817 | |             .expect("acquire");
    | |______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:820:20
    |
820 |         let data = backend.get("test.lock").await.expect("get");
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:821:30
    |
821 |         let info: LockInfo = serde_json::from_slice(&data).expect("parse");
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:824:9
    |
824 |         guard.release().await.expect("release");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:832:25
    |
832 |           let mut guard = lock
    |  _________________________^
833 | |             .acquire(Duration::from_secs(1), 1)
834 | |             .await
835 | |             .expect("acquire");
    | |______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:838:9
    |
838 |         guard.extend(Duration::from_secs(30)).await.expect("extend");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:841:20
    |
841 |         let data = backend.get("test.lock").await.expect("get");
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:842:30
    |
842 |         let info: LockInfo = serde_json::from_slice(&data).expect("parse");
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/lock.rs:845:9
    |
845 |         guard.release().await.expect("release");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: variables can be used directly in the `format!` string
   --> crates/arco-core/src/observability.rs:223:28
    |
223 |         let debug_output = format!("{:?}", secret);
    |                            ^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
    = note: `-D clippy::uninlined-format-args` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::uninlined_format_args)]`
help: change this to
    |
223 -         let debug_output = format!("{:?}", secret);
223 +         let debug_output = format!("{secret:?}");
    |

error: variables can be used directly in the `format!` string
   --> crates/arco-core/src/observability.rs:232:30
    |
232 |         let display_output = format!("{}", secret);
    |                              ^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
    |
232 -         let display_output = format!("{}", secret);
232 +         let display_output = format!("{secret}");
    |

error: you seem to be trying to use `match` for destructuring a single pattern. Consider using `if let`
   --> crates/arco-core/src/partition.rs:512:26
    |
512 |           let value_part = match canonical.split_once('=') {
    |  __________________________^
513 | |             Some((_key, value)) => value,
514 | |             None => {
515 | |                 assert!(false, "canonical string should contain '=': {canonical}");
...   |
518 | |         };
    | |_________^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#single_match_else
    = note: `-D clippy::single-match-else` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::single_match_else)]`
help: try
    |
512 ~         let value_part = if let Some((_key, value)) = canonical.split_once('=') { value } else {
513 +             assert!(false, "canonical string should contain '=': {canonical}");
514 +             ""
515 ~         };
    |

error: `assert!(false, ..)` should probably be replaced
   --> crates/arco-core/src/partition.rs:515:17
    |
515 |                 assert!(false, "canonical string should contain '=': {canonical}");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: use `panic!(..)` or `unreachable!(..)`
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#assertions_on_constants
    = note: `-D clippy::assertions-on-constants` implied by `-D clippy::all`
    = help: to override `-D clippy::all` add `#[allow(clippy::assertions_on_constants)]`

error: `assert!(false, ..)` should probably be replaced
   --> crates/arco-core/src/partition.rs:611:17
    |
611 |                 assert!(false, "partition key should roundtrip: {err}");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: use `panic!(..)` or `unreachable!(..)`
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#assertions_on_constants

error: could not compile `arco-delta` (lib) due to 2 previous errors
error: could not compile `arco-delta` (lib test) due to 1 previous error
error: could not compile `arco-uc` (lib test)

Caused by:
  process didn't exit successfully: `/Users/ethanurbanski/.rustup/toolchains/1.85-aarch64-apple-darwin/bin/clippy-driver /Users/ethanurbanski/.rustup/toolchains/1.85-aarch64-apple-darwin/bin/rustc --crate-name arco_uc --edition=2024 crates/arco-uc/src/lib.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat --emit=dep-info,metadata -C embed-bitcode=no -C debuginfo=2 -C split-debuginfo=unpacked --deny=rust_2018_idioms '--warn=clippy::pedantic' '--warn=clippy::nursery' '--warn=clippy::cargo' '--deny=clippy::all' '--deny=clippy::unwrap_used' --deny=unused_qualifications --deny=unused_lifetimes --forbid=unsafe_code '--warn=clippy::unimplemented' --deny=trivial_casts '--warn=clippy::todo' '--warn=clippy::print_stdout' '--warn=clippy::print_stderr' '--deny=clippy::panic' '--allow=clippy::must_use_candidate' '--allow=clippy::multiple_crate_versions' '--allow=clippy::module_name_repetitions' '--allow=clippy::missing_panics_doc' '--allow=clippy::missing_errors_doc' --deny=missing_docs '--allow=clippy::missing_const_for_fn' '--warn=clippy::indexing_slicing' '--deny=clippy::expect_used' '--warn=clippy::dbg_macro' '--allow=clippy::cargo_common_metadata' --test --cfg 'feature="aws"' --cfg 'feature="azure"' --cfg 'feature="default"' --cfg 'feature="full"' --cfg 'feature="gcp"' --check-cfg 'cfg(docsrs,test)' --check-cfg 'cfg(feature, values("aws", "azure", "default", "full", "gcp"))' -C metadata=af2907e97d357d02 -C extra-filename=-34be9a49376fe298 --out-dir /Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps -C incremental=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/incremental -L dependency=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps --extern arco_core=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libarco_core-7791f0039d9ddb28.rmeta --extern axum=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libaxum-a35dc027b32738af.rmeta --extern gcp_auth=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libgcp_auth-f0ec44abc080e1fd.rmeta --extern http=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libhttp-79653342c35080e2.rmeta --extern serde=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libserde-e279f61dda855866.rmeta --extern serde_json=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libserde_json-46e8465860f5603a.rmeta --extern serde_yaml=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libserde_yaml-c090a68f72e0e553.rmeta --extern thiserror=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libthiserror-c91f2c8ea8cf6300.rmeta --extern tokio=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtokio-9a7c9a164973d8b2.rmeta --extern tokio_test=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtokio_test-d72398a25f2ad41f.rmeta --extern tower=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtower-3c50afe1f8d76e2f.rmeta --extern tower_http=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtower_http-a083b6e2b444d8eb.rmeta --extern tracing=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtracing-98258bcf9edd9d72.rmeta --extern ulid=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libulid-a5582d4aef0c6eef.rmeta --extern utoipa=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libutoipa-5eca9b77de936612.rmeta -L native=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/build/aws-lc-sys-33d6dbba370710fa/out -L native=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/build/ring-37f3de2c910507f5/out` (signal: 6, SIGABRT: process abort signal)
error: used `expect()` on a `Result` value
   --> crates/arco-core/src/publish.rs:513:22
    |
513 |           let result = publisher
    |  ______________________^
514 | |             .publish(permit, &key, Bytes::from(r#"{"version": 1}"#))
515 | |             .await
516 | |             .expect("publish");
    | |______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/publish.rs:526:9
    |
526 | /         backend
527 | |             .put(
528 | |                 "manifests/catalog.manifest.json",
529 | |                 Bytes::from(r#"{"version": 1}"#),
...   |
532 | |             .await
533 | |             .expect("first write");
    | |__________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/publish.rs:542:22
    |
542 |           let result = publisher
    |  ______________________^
543 | |             .publish(permit, &key, Bytes::from(r#"{"version": 2}"#))
544 | |             .await
545 | |             .expect("publish");
    | |______________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:647:23
    |
647 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used
    = note: requested on the command line with `-D clippy::unwrap-used`

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:680:23
    |
680 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:700:23
    |
700 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:716:23
    |
716 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:733:20
    |
733 |         let prod = ScopedStorage::new(backend.clone(), "acme", "production").unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:734:23
    |
734 |         let staging = ScopedStorage::new(backend.clone(), "acme", "staging").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:736:9
    |
736 | /         prod.put_raw(
737 | |             "test.txt",
738 | |             Bytes::from("prod-data"),
739 | |             WritePrecondition::None,
740 | |         )
741 | |         .await
742 | |         .expect("put should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:743:9
    |
743 | /         staging
744 | |             .put_raw(
745 | |                 "test.txt",
746 | |                 Bytes::from("staging-data"),
...   |
749 | |             .await
750 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:753:25
    |
753 |         let prod_data = prod.get_raw("test.txt").await.expect("get should succeed");
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:754:28
    |
754 |           let staging_data = staging
    |  ____________________________^
755 | |             .get_raw("test.txt")
756 | |             .await
757 | |             .expect("get should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:767:20
    |
767 |         let acme = ScopedStorage::new(backend.clone(), "acme", "production").unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:768:22
    |
768 |         let globex = ScopedStorage::new(backend.clone(), "globex", "production").unwrap();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:770:9
    |
770 | /         acme.put_raw(
771 | |             "test.txt",
772 | |             Bytes::from("acme-data"),
773 | |             WritePrecondition::None,
774 | |         )
775 | |         .await
776 | |         .expect("put should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:777:9
    |
777 | /         globex
778 | |             .put_raw(
779 | |                 "test.txt",
780 | |                 Bytes::from("globex-data"),
...   |
783 | |             .await
784 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:786:25
    |
786 |         let acme_data = acme.get_raw("test.txt").await.expect("get should succeed");
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:787:27
    |
787 |           let globex_data = globex
    |  ___________________________^
788 | |             .get_raw("test.txt")
789 | |             .await
790 | |             .expect("get should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:800:23
    |
800 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:804:9
    |
804 | /         storage
805 | |             .put_core_manifest(manifest_data.clone(), WritePrecondition::None)
806 | |             .await
807 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:810:25
    |
810 |           let retrieved = storage
    |  _________________________^
811 | |             .get_core_manifest()
812 | |             .await
813 | |             .expect("get should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:827:23
    |
827 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:863:25
    |
863 |         let acme_prod = ScopedStorage::new(backend.clone(), "acme", "production").unwrap();
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:864:28
    |
864 |         let acme_staging = ScopedStorage::new(backend.clone(), "acme", "staging").unwrap();
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:865:27
    |
865 |         let globex_prod = ScopedStorage::new(backend.clone(), "globex", "production").unwrap();
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:868:9
    |
868 | /         acme_prod
869 | |             .put_raw(
870 | |                 "secret1.txt",
871 | |                 Bytes::from("acme-prod"),
...   |
874 | |             .await
875 | |             .expect("put");
    | |__________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:876:9
    |
876 | /         acme_staging
877 | |             .put_raw(
878 | |                 "secret2.txt",
879 | |                 Bytes::from("acme-staging"),
...   |
882 | |             .await
883 | |             .expect("put");
    | |__________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:884:9
    |
884 | /         globex_prod
885 | |             .put_raw(
886 | |                 "secret3.txt",
887 | |                 Bytes::from("globex-prod"),
...   |
890 | |             .await
891 | |             .expect("put");
    | |__________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:894:31
    |
894 |         let acme_prod_files = acme_prod.list("").await.expect("list");
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:895:34
    |
895 |         let acme_staging_files = acme_staging.list("").await.expect("list");
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:896:33
    |
896 |         let globex_prod_files = globex_prod.list("").await.expect("list");
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
   --> crates/arco-core/src/scoped_storage.rs:907:17
    |
907 |         assert!(acme_prod_files[0].as_str().contains("secret1.txt"));
    |                 ^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-core/src/scoped_storage.rs:908:17
    |
908 |         assert!(acme_staging_files[0].as_str().contains("secret2.txt"));
    |                 ^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-core/src/scoped_storage.rs:909:17
    |
909 |         assert!(globex_prod_files[0].as_str().contains("secret3.txt"));
    |                 ^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:919:20
    |
919 |         let acme = ScopedStorage::new(backend.clone(), "acme", "production").unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:920:22
    |
920 |         let globex = ScopedStorage::new(backend.clone(), "globex", "production").unwrap();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:923:9
    |
923 | /         acme.put_raw(
924 | |             "secret.txt",
925 | |             Bytes::from("acme-secret"),
926 | |             WritePrecondition::None,
927 | |         )
928 | |         .await
929 | |         .expect("put");
    | |______________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:932:25
    |
932 |         let acme_data = acme.get_raw("secret.txt").await.expect("should succeed");
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:946:20
    |
946 |         let acme = ScopedStorage::new(backend.clone(), "acme", "production").unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:947:22
    |
947 |         let globex = ScopedStorage::new(backend.clone(), "globex", "production").unwrap();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:950:9
    |
950 | /         acme.put_raw(
951 | |             "important.txt",
952 | |             Bytes::from("critical-data"),
953 | |             WritePrecondition::None,
954 | |         )
955 | |         .await
956 | |         .expect("put");
    | |______________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/scoped_storage.rs:963:25
    |
963 |           let acme_data = acme
    |  _________________________^
964 | |             .get_raw("important.txt")
965 | |             .await
966 | |             .expect("should still exist");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-core/src/scoped_storage.rs:1004:23
     |
1004 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
    --> crates/arco-core/src/scoped_storage.rs:1006:9
     |
1006 | /         storage
1007 | |             .put_raw("file.txt", Bytes::from("data"), WritePrecondition::None)
1008 | |             .await
1009 | |             .expect("put");
     | |__________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-core/src/scoped_storage.rs:1011:20
     |
1011 |         let data = storage.get_raw("file.txt").await.expect("get");
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-core/src/scoped_storage.rs:1022:23
     |
1022 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-core/src/scoped_storage.rs:1049:23
     |
1049 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-core/src/scoped_storage.rs:1064:23
     |
1064 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-core/src/scoped_storage.rs:1079:23
     |
1079 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-core/src/scoped_storage.rs:1094:23
     |
1094 |         let storage = ScopedStorage::new(backend, "acme", "production").unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:635:22
    |
635 |           let result = backend
    |  ______________________^
636 | |             .put("test/file.txt", data.clone(), WritePrecondition::None)
637 | |             .await
638 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:642:25
    |
642 |           let retrieved = backend
    |  _________________________^
643 | |             .get("test/file.txt")
644 | |             .await
645 | |             .expect("get should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:652:9
    |
652 | /         backend
653 | |             .put("test.txt", Bytes::from("data"), WritePrecondition::None)
654 | |             .await
655 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
   --> crates/arco-core/src/storage.rs:657:20
    |
657 |           let meta = backend
    |  ____________________^
658 | |             .head("test.txt")
659 | |             .await
660 | |             .expect("head should succeed")
661 | |             .expect("object should exist");
    | |__________________________________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:657:20
    |
657 |           let meta = backend
    |  ____________________^
658 | |             .head("test.txt")
659 | |             .await
660 | |             .expect("head should succeed")
    | |__________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:674:9
    |
674 | /         backend
675 | |             .put(
676 | |                 "test.txt",
677 | |                 Bytes::from("hello world"),
...   |
680 | |             .await
681 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:683:22
    |
683 |           let result = backend
    |  ______________________^
684 | |             .get_range("test.txt", 0..5)
685 | |             .await
686 | |             .expect("should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:693:9
    |
693 | /         backend
694 | |             .put("test.txt", Bytes::from("hello"), WritePrecondition::None)
695 | |             .await
696 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:699:22
    |
699 |           let result = backend
    |  ______________________^
700 | |             .get_range("test.txt", 0..100)
701 | |             .await
702 | |             .expect("should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:709:9
    |
709 | /         backend
710 | |             .put("test.txt", Bytes::from("hello"), WritePrecondition::None)
711 | |             .await
712 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:722:9
    |
722 | /         backend
723 | |             .put(
724 | |                 "test.txt",
725 | |                 Bytes::from("hello world"),
...   |
728 | |             .await
729 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: this range is empty so it will yield no values
   --> crates/arco-core/src/storage.rs:732:52
    |
732 |         let result = backend.get_range("test.txt", 8..2).await;
    |                                                    ^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#reversed_empty_ranges
    = note: `-D clippy::reversed-empty-ranges` implied by `-D clippy::all`
    = help: to override `-D clippy::all` add `#[allow(clippy::reversed_empty_ranges)]`
help: consider using the following if you are attempting to iterate over this range in reverse
    |
732 |         let result = backend.get_range("test.txt", (2..8).rev()).await;
    |                                                    ~~~~~~~~~~~~

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:739:9
    |
739 | /         backend
740 | |             .put("test.txt", Bytes::from("data"), WritePrecondition::None)
741 | |             .await
742 | |             .expect("put should succeed");
    | |_________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:744:19
    |
744 |           let url = backend
    |  ___________________^
745 | |             .signed_url("test.txt", Duration::from_secs(3600))
746 | |             .await
747 | |             .expect("signed_url should succeed");
    | |________________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:759:22
    |
759 |           let result = backend
    |  ______________________^
760 | |             .put(
761 | |                 "new.txt",
762 | |                 Bytes::from("data"),
...   |
765 | |             .await
766 | |             .expect("should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:770:22
    |
770 |           let result = backend
    |  ______________________^
771 | |             .put(
772 | |                 "new.txt",
773 | |                 Bytes::from("data2"),
...   |
776 | |             .await
777 | |             .expect("should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:786:22
    |
786 |           let result = backend
    |  ______________________^
787 | |             .put("gen.txt", Bytes::from("v1"), WritePrecondition::None)
788 | |             .await
789 | |             .expect("should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: this could be rewritten as `let...else`
   --> crates/arco-core/src/storage.rs:790:9
    |
790 | /         let first_version = match result {
791 | |             WriteResult::Success { version } => version,
792 | |             _ => panic!("expected success"),
793 | |         };
    | |__________^ help: consider writing: `let WriteResult::Success { version: first_version } = result else { panic!("expected success") };`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#manual_let_else
    = note: `-D clippy::manual-let-else` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::manual_let_else)]`

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-core/src/storage.rs:792:13
    |
792 |             _ => panic!("expected success"),
    |             ^ help: try: `WriteResult::PreconditionFailed{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants
    = note: `-D clippy::match-wildcard-for-single-variants` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::match_wildcard_for_single_variants)]`

error: `panic` should not be present in production code
   --> crates/arco-core/src/storage.rs:792:18
    |
792 |             _ => panic!("expected success"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic
    = note: requested on the command line with `-D clippy::panic`

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:796:22
    |
796 |           let result = backend
    |  ______________________^
797 | |             .put(
798 | |                 "gen.txt",
799 | |                 Bytes::from("v2"),
...   |
802 | |             .await
803 | |             .expect("should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:807:22
    |
807 |           let result = backend
    |  ______________________^
808 | |             .put(
809 | |                 "gen.txt",
810 | |                 Bytes::from("v3"),
...   |
813 | |             .await
814 | |             .expect("should succeed");
    | |_____________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/storage.rs:822:9
    |
822 | /         backend
823 | |             .put("a/1.txt", Bytes::from("a1"), WritePrecondition::None)
824 | |             .await
825 | |             .unwrap();
    | |_____________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/storage.rs:826:9
    |
826 | /         backend
827 | |             .put("a/2.txt", Bytes::from("a2"), WritePrecondition::None)
828 | |             .await
829 | |             .unwrap();
    | |_____________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/storage.rs:830:9
    |
830 | /         backend
831 | |             .put("b/1.txt", Bytes::from("b1"), WritePrecondition::None)
832 | |             .await
833 | |             .unwrap();
    | |_____________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:835:22
    |
835 |         let list_a = backend.list("a/").await.expect("should succeed");
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:838:22
    |
838 |         let list_b = backend.list("b/").await.expect("should succeed");
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/storage.rs:846:9
    |
846 | /         backend
847 | |             .put("del.txt", Bytes::from("data"), WritePrecondition::None)
848 | |             .await
849 | |             .unwrap();
    | |_____________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/storage.rs:850:17
    |
850 |         assert!(backend.head("del.txt").await.unwrap().is_some());
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage.rs:852:9
    |
852 |         backend.delete("del.txt").await.expect("should succeed");
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/storage.rs:853:17
    |
853 |         assert!(backend.head("del.txt").await.unwrap().is_none());
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:357:9
    |
357 | /         backend
358 | |             .put(
359 | |                 "test.txt",
360 | |                 Bytes::from("hello"),
...   |
363 | |             .await
364 | |             .expect("write");
    | |____________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:368:20
    |
368 |         let data = reader.get("test.txt").await.expect("read");
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:379:22
    |
379 |           let result = writer
    |  ______________________^
380 | |             .put_ledger(&key, Bytes::from("{}"))
381 | |             .await
382 | |             .expect("write");
    | |____________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:386:22
    |
386 |           let result = writer
    |  ______________________^
387 | |             .put_ledger(&key, Bytes::from("{}"))
388 | |             .await
389 | |             .expect("write");
    | |____________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:399:22
    |
399 |           let result = backend
    |  ______________________^
400 | |             .put(
401 | |                 key.as_ref(),
402 | |                 Bytes::from("v1"),
...   |
405 | |             .await
406 | |             .expect("create");
    | |_____________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: this could be rewritten as `let...else`
   --> crates/arco-core/src/storage_traits.rs:407:9
    |
407 | /         let version = match result {
408 | |             WriteResult::Success { version } => version,
409 | |             _ => panic!("expected success"),
410 | |         };
    | |__________^ help: consider writing: `let WriteResult::Success { version } = result else { panic!("expected success") };`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#manual_let_else

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-core/src/storage_traits.rs:409:13
    |
409 |             _ => panic!("expected success"),
    |             ^ help: try: `WriteResult::PreconditionFailed{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: `panic` should not be present in production code
   --> crates/arco-core/src/storage_traits.rs:409:18
    |
409 |             _ => panic!("expected success"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:414:22
    |
414 |           let result = cas_store
    |  ______________________^
415 | |             .cas(&key, Bytes::from("v2"), &version)
416 | |             .await
417 | |             .expect("cas");
    | |__________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:421:22
    |
421 |           let result = cas_store
    |  ______________________^
422 | |             .cas(&key, Bytes::from("v3"), &version)
423 | |             .await
424 | |             .expect("cas");
    | |__________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:434:22
    |
434 |         let result = meta_store.head("missing.txt").await.expect("head");
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:438:9
    |
438 | /         backend
439 | |             .put(
440 | |                 "exists.txt",
441 | |                 Bytes::from("data"),
...   |
444 | |             .await
445 | |             .expect("create");
    | |_____________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-core/src/storage_traits.rs:448:22
    |
448 |         let result = meta_store.head("exists.txt").await.expect("head");
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-core/src/storage_traits.rs:450:20
    |
450 |         assert_eq!(result.unwrap().size, 4);
    |                    ^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/callbacks/types.rs:441:33
    |
441 |                 byte_size: Some(52428800),
    |                                 ^^^^^^^^ help: consider: `52_428_800`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal
    = note: `-D clippy::unreadable-literal` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::unreadable_literal)]`

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/callbacks/types.rs:447:41
    |
447 |                 peak_memory_bytes: Some(2147483648),
    |                                         ^^^^^^^^^^ help: consider: `2_147_483_648`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/callbacks/types.rs:448:37
    |
448 |                 io_read_bytes: Some(10485760),
    |                                     ^^^^^^^^ help: consider: `10_485_760`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/callbacks/types.rs:449:38
    |
449 |                 io_write_bytes: Some(52428800),
    |                                      ^^^^^^^^ help: consider: `52_428_800`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: used `unwrap()` on a `Result` value
   --> crates/arco-core/src/tenant.rs:157:22
    |
157 |         let tenant = TenantId::new("acme-corp").unwrap();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3943:39
     |
3943 |         assert_eq!(parsed.fire_epoch, 1705320000);
     |                                       ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3951:39
     |
3951 |         assert_eq!(parsed.fire_epoch, 1705320000);
     |                                       ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3959:39
     |
3959 |         assert_eq!(parsed.fire_epoch, 1705320000);
     |                                       ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3967:39
     |
3967 |         assert_eq!(parsed.fire_epoch, 1705320000);
     |                                       ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3982:26
     |
3982 |         let fire_epoch = 1705320000i64;
     |                          ^^^^^^^^^^^^^ help: consider: `1_705_320_000_i64`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4027:26
     |
4027 |         let fire_epoch = 1705320000i64;
     |                          ^^^^^^^^^^^^^ help: consider: `1_705_320_000_i64`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4054:26
     |
4054 |         let fire_epoch = 1705320000i64;
     |                          ^^^^^^^^^^^^^ help: consider: `1_705_320_000_i64`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4084:27
     |
4084 |         let fire_epoch1 = 1705320000i64;
     |                           ^^^^^^^^^^^^^ help: consider: `1_705_320_000_i64`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4085:27
     |
4085 |         let fire_epoch2 = 1705320060i64;
     |                           ^^^^^^^^^^^^^ help: consider: `1_705_320_060_i64`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4098:69
     |
4098 |         let id = TimerRow::heartbeat_timer_id("run1", "extract", 1, 1705320000);
     |                                                                     ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4104:55
     |
4104 |         let id = TimerRow::cron_timer_id("daily-etl", 1705320000);
     |                                                       ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4135:71
     |
4135 |         let timer_id = TimerRow::retry_timer_id("run1", "extract", 1, 1705320000);
     |                                                                       ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4242:47
     |
4242 |             fire_at: DateTime::from_timestamp(1705320000, 0).unwrap(),
     |                                               ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4249:47
     |
4249 |             fire_at: DateTime::from_timestamp(1705320030, 0).unwrap(),
     |                                               ^^^^^^^^^^ help: consider: `1_705_320_030`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4254:48
     |
4254 |         assert_eq!(merged.fire_at.timestamp(), 1705320030);
     |                                                ^^^^^^^^^^ help: consider: `1_705_320_030`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4310:71
     |
4310 |         let timer_id = TimerRow::retry_timer_id("run1", "extract", 1, 1705320000);
     |                                                                       ^^^^^^^^^^ help: consider: `1_705_320_000`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4995:29
     |
4995 |                 poll_epoch: 1736935200,
     |                             ^^^^^^^^^^ help: consider: `1_736_935_200`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5049:29
     |
5049 |                 poll_epoch: 1736935200,
     |                             ^^^^^^^^^^ help: consider: `1_736_935_200`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5098:29
     |
5098 |                 poll_epoch: 1736935200,
     |                             ^^^^^^^^^^ help: consider: `1_736_935_200`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: could not compile `arco-core` (lib test) due to 133 previous errors

Caused by:
  process didn't exit successfully: `/Users/ethanurbanski/.rustup/toolchains/1.85-aarch64-apple-darwin/bin/clippy-driver /Users/ethanurbanski/.rustup/toolchains/1.85-aarch64-apple-darwin/bin/rustc --crate-name arco_core --edition=2024 crates/arco-core/src/lib.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat --emit=dep-info,metadata -C embed-bitcode=no -C debuginfo=2 -C split-debuginfo=unpacked --deny=rust_2018_idioms '--warn=clippy::pedantic' '--warn=clippy::nursery' '--warn=clippy::cargo' '--deny=clippy::all' '--deny=clippy::unwrap_used' --deny=unused_qualifications --deny=unused_lifetimes --forbid=unsafe_code '--warn=clippy::unimplemented' --deny=trivial_casts '--warn=clippy::todo' '--warn=clippy::print_stdout' '--warn=clippy::print_stderr' '--deny=clippy::panic' '--allow=clippy::must_use_candidate' '--allow=clippy::multiple_crate_versions' '--allow=clippy::module_name_repetitions' '--allow=clippy::missing_panics_doc' '--allow=clippy::missing_errors_doc' --deny=missing_docs '--allow=clippy::missing_const_for_fn' '--warn=clippy::indexing_slicing' '--deny=clippy::expect_used' '--warn=clippy::dbg_macro' '--allow=clippy::cargo_common_metadata' --test --cfg 'feature="aws"' --cfg 'feature="azure"' --cfg 'feature="default"' --cfg 'feature="full"' --cfg 'feature="gcp"' --cfg 'feature="sync-compaction"' --cfg 'feature="test-utils"' --check-cfg 'cfg(docsrs,test)' --check-cfg 'cfg(feature, values("aws", "azure", "default", "full", "gcp", "sync-compaction", "test-utils"))' -C metadata=ac34569493b836c7 -C extra-filename=-1f34d21769911f0c --out-dir /Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps -C incremental=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/incremental -L dependency=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps --extern async_trait=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libasync_trait-72623dde2829653d.dylib --extern base64=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libbase64-21198de9bcaff942.rmeta --extern bytes=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libbytes-7ac386b75d41a94a.rmeta --extern chrono=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libchrono-53ff5cdddbec3235.rmeta --extern futures=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libfutures-641e2fbd74d767f2.rmeta --extern hex=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libhex-b2c9600fee6ff808.rmeta --extern http=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libhttp-79653342c35080e2.rmeta --extern object_store=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libobject_store-a23de06096af5135.rmeta --extern proptest=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libproptest-bec5e225bd5e0aed.rmeta --extern serde=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libserde-e279f61dda855866.rmeta --extern serde_json=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libserde_json-46e8465860f5603a.rmeta --extern sha2=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libsha2-dd7e878f7f14a7e2.rmeta --extern tempfile=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtempfile-dc18a960531de455.rmeta --extern thiserror=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libthiserror-c91f2c8ea8cf6300.rmeta --extern tokio=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtokio-9a7c9a164973d8b2.rmeta --extern tokio_test=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtokio_test-d72398a25f2ad41f.rmeta --extern tracing=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtracing-98258bcf9edd9d72.rmeta --extern tracing_subscriber=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtracing_subscriber-50b2b28c94fe7bb9.rmeta --extern trybuild=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtrybuild-fcd4dec6c4d6bf85.rmeta --extern ulid=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libulid-a5582d4aef0c6eef.rmeta --extern uuid=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libuuid-d66ceef1953d7c60.rmeta -L native=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/build/aws-lc-sys-33d6dbba370710fa/out -L native=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/build/ring-37f3de2c910507f5/out` (signal: 6, SIGABRT: process abort signal)
error: long literal lacking separators
  --> crates/arco-flow/src/orchestration/controllers/dispatch.rs:74:66
   |
74 |         let id = retry_timer_internal_id("run123", "extract", 1, 1705340400);
   |                                                                  ^^^^^^^^^^ help: consider: `1_705_340_400`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
  --> crates/arco-flow/src/orchestration/controllers/dispatch.rs:80:70
   |
80 |         let id = heartbeat_timer_internal_id("run123", "extract", 1, 1705340400);
   |                                                                      ^^^^^^^^^^ help: consider: `1_705_340_400`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
  --> crates/arco-flow/src/orchestration/controllers/dispatch.rs:86:54
   |
86 |         let id = cron_timer_internal_id("daily-etl", 1705340400);
   |                                                      ^^^^^^^^^^ help: consider: `1_705_340_400`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:586:13
    |
586 |             1736935200,
    |             ^^^^^^^^^^ help: consider: `1_736_935_200`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:742:13
    |
742 |             1736935200,
    |             ^^^^^^^^^^ help: consider: `1_736_935_200`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:786:13
    |
786 |             1736935200,
    |             ^^^^^^^^^^ help: consider: `1_736_935_200`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:815:37
    |
815 |                         poll_epoch: 1736935200
    |                                     ^^^^^^^^^^ help: consider: `1_736_935_200`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: long literal lacking separators
   --> crates/arco-flow/src/orchestration/events/automation_events.rs:158:25
    |
158 |             poll_epoch: 1736935200,
    |                         ^^^^^^^^^^ help: consider: `1_736_935_200`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unreadable_literal

error: binding's name is too similar to existing binding
   --> crates/arco-flow/src/outbox.rs:179:13
    |
179 |         let data = storage.get_raw(&path).await?;
    |             ^^^^
    |
note: existing binding defined here
   --> crates/arco-flow/src/outbox.rs:176:13
    |
176 |         let date = event_time.format("%Y-%m-%d").to_string();
    |             ^^^^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#similar_names
    = note: `-D clippy::similar-names` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::similar_names)]`

error: binding's name is too similar to existing binding
    --> crates/arco-flow/src/plan.rs:1107:13
     |
1107 |         let task_b1 = TaskId::generate();
     |             ^^^^^^^
     |
note: existing binding defined here
    --> crates/arco-flow/src/plan.rs:1106:13
     |
1106 |         let task_a1 = TaskId::generate();
     |             ^^^^^^^
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#similar_names

error: binding's name is too similar to existing binding
    --> crates/arco-flow/src/plan.rs:1108:13
     |
1108 |         let task_c1 = TaskId::generate();
     |             ^^^^^^^
     |
note: existing binding defined here
    --> crates/arco-flow/src/plan.rs:1106:13
     |
1106 |         let task_a1 = TaskId::generate();
     |             ^^^^^^^
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#similar_names

error: binding's name is too similar to existing binding
    --> crates/arco-flow/src/plan.rs:1148:13
     |
1148 |         let task_b2 = TaskId::generate();
     |             ^^^^^^^
     |
note: existing binding defined here
    --> crates/arco-flow/src/plan.rs:1106:13
     |
1106 |         let task_a1 = TaskId::generate();
     |             ^^^^^^^
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#similar_names

error: binding's name is too similar to existing binding
    --> crates/arco-flow/src/plan.rs:1149:13
     |
1149 |         let task_c2 = TaskId::generate();
     |             ^^^^^^^
     |
note: existing binding defined here
    --> crates/arco-flow/src/plan.rs:1106:13
     |
1106 |         let task_a1 = TaskId::generate();
     |             ^^^^^^^
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#similar_names

error: indexing may panic
    --> crates/arco-catalog/src/compactor.rs:1295:13
     |
1295 |             quarantined[0]
     |             ^^^^^^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing
     = note: `-D clippy::indexing-slicing` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::indexing_slicing)]`

error: indexing may panic
    --> crates/arco-catalog/src/compactor.rs:1365:17
     |
1365 |         assert!(quarantined[0].as_str().ends_with(&format!("{id_mid}.json")));
     |                 ^^^^^^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: this looks like a formatting argument but it is not part of a formatting macro
 --> crates/arco-catalog/src/lib.rs:3:41
  |
3 | //! Catalog service for the Arco serverless lakehouse infrastructure.
  |                                         ^^^^^^^^
  |
  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#literal_string_with_formatting_args
  = note: `-D clippy::literal-string-with-formatting-args` implied by `-D warnings`
  = help: to override `-D warnings` add `#[allow(clippy::literal_string_with_formatting_args)]`

error: manual `RangeInclusive::contains` implementation
    --> crates/arco-catalog/src/idempotency.rs:1207:17
     |
1207 |         assert!(retry >= 1 && retry <= 300, "fresh marker retry={retry}");
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use: `(1..=300).contains(&retry)`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#manual_range_contains
     = note: `-D clippy::manual-range-contains` implied by `-D clippy::all`
     = help: to override `-D clippy::all` add `#[allow(clippy::manual_range_contains)]`

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:946:20
    |
946 |         assert_eq!(rows[0].id, "ns_1");
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:947:20
    |
947 |         assert_eq!(rows[0].catalog_id, None);
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:948:20
    |
948 |         assert_eq!(rows[0].name, "default");
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:949:20
    |
949 |         assert_eq!(rows[0].description, None);
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:986:20
    |
986 |         assert_eq!(rows[0].id, "tbl_1");
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:987:20
    |
987 |         assert_eq!(rows[0].namespace_id, "ns_1");
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:988:20
    |
988 |         assert_eq!(rows[0].name, "users");
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:989:20
    |
989 |         assert_eq!(rows[0].description, None);
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:990:20
    |
990 |         assert_eq!(rows[0].location, None);
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-catalog/src/parquet_util.rs:991:20
    |
991 |         assert_eq!(rows[0].format, None);
    |                    ^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-catalog/src/parquet_util.rs:1031:20
     |
1031 |         assert_eq!(rows[0].id, "col_1");
     |                    ^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-catalog/src/parquet_util.rs:1032:20
     |
1032 |         assert_eq!(rows[0].table_id, "tbl_1");
     |                    ^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-catalog/src/parquet_util.rs:1033:20
     |
1033 |         assert_eq!(rows[0].name, "user_id");
     |                    ^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-catalog/src/parquet_util.rs:1034:20
     |
1034 |         assert_eq!(rows[0].description, None);
     |                    ^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-catalog/src/parquet_util.rs:1071:20
     |
1071 |         assert_eq!(rows[0].id, "edge_1");
     |                    ^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-catalog/src/parquet_util.rs:1072:20
     |
1072 |         assert_eq!(rows[0].source_id, "tbl_a");
     |                    ^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-catalog/src/parquet_util.rs:1073:20
     |
1073 |         assert_eq!(rows[0].target_id, "tbl_b");
     |                    ^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-catalog/src/parquet_util.rs:1074:20
     |
1074 |         assert_eq!(rows[0].run_id, None);
     |                    ^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: this looks like a formatting argument but it is not part of a formatting macro
 --> crates/arco-catalog/src/lib.rs:3:6
  |
3 | //! Catalog service for the Arco serverless lakehouse infrastructure.
  |      ^^^^
  |
  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#literal_string_with_formatting_args

error: could not compile `arco-catalog` (lib test) due to 23 previous errors

Caused by:
  process didn't exit successfully: `/Users/ethanurbanski/.rustup/toolchains/1.85-aarch64-apple-darwin/bin/clippy-driver /Users/ethanurbanski/.rustup/toolchains/1.85-aarch64-apple-darwin/bin/rustc --crate-name arco_catalog --edition=2024 crates/arco-catalog/src/lib.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat --emit=dep-info,metadata -C embed-bitcode=no -C debuginfo=2 -C split-debuginfo=unpacked --deny=rust_2018_idioms '--warn=clippy::pedantic' '--warn=clippy::nursery' '--warn=clippy::cargo' '--deny=clippy::all' '--deny=clippy::unwrap_used' --deny=unused_qualifications --deny=unused_lifetimes --forbid=unsafe_code '--warn=clippy::unimplemented' --deny=trivial_casts '--warn=clippy::todo' '--warn=clippy::print_stdout' '--warn=clippy::print_stderr' '--deny=clippy::panic' '--allow=clippy::must_use_candidate' '--allow=clippy::multiple_crate_versions' '--allow=clippy::module_name_repetitions' '--allow=clippy::missing_panics_doc' '--allow=clippy::missing_errors_doc' --deny=missing_docs '--allow=clippy::missing_const_for_fn' '--warn=clippy::indexing_slicing' '--deny=clippy::expect_used' '--warn=clippy::dbg_macro' '--allow=clippy::cargo_common_metadata' --test --cfg 'feature="aws"' --cfg 'feature="azure"' --cfg 'feature="default"' --cfg 'feature="full"' --cfg 'feature="gcp"' --cfg 'feature="test-utils"' --check-cfg 'cfg(docsrs,test)' --check-cfg 'cfg(feature, values("aws", "azure", "default", "full", "gcp", "test-utils"))' -C metadata=53aa3f79f6c96f6a -C extra-filename=-12614c06565ebfda --out-dir /Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps -C incremental=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/incremental -L dependency=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps --extern arco_core=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libarco_core-7791f0039d9ddb28.rmeta --extern arrow=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libarrow-9e7bff2382068a58.rmeta --extern async_trait=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libasync_trait-72623dde2829653d.dylib --extern bytes=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libbytes-7ac386b75d41a94a.rmeta --extern chrono=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libchrono-53ff5cdddbec3235.rmeta --extern criterion=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libcriterion-90a7a36517b84e9f.rmeta --extern futures=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libfutures-641e2fbd74d767f2.rmeta --extern hex=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libhex-b2c9600fee6ff808.rmeta --extern metrics=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libmetrics-e713be64f1de0b03.rmeta --extern object_store=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libobject_store-a23de06096af5135.rmeta --extern parquet=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libparquet-7c7f1f8317f9c0a6.rmeta --extern proptest=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libproptest-bec5e225bd5e0aed.rmeta --extern serde=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libserde-e279f61dda855866.rmeta --extern serde_jcs=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libserde_jcs-ade31004c1d362c1.rmeta --extern serde_json=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libserde_json-46e8465860f5603a.rmeta --extern sha2=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libsha2-dd7e878f7f14a7e2.rmeta --extern tempfile=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtempfile-dc18a960531de455.rmeta --extern thiserror=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libthiserror-c91f2c8ea8cf6300.rmeta --extern tokio=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtokio-9a7c9a164973d8b2.rmeta --extern tokio_test=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtokio_test-d72398a25f2ad41f.rmeta --extern tracing=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libtracing-98258bcf9edd9d72.rmeta --extern ulid=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libulid-a5582d4aef0c6eef.rmeta --extern uuid=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/deps/libuuid-d66ceef1953d7c60.rmeta -L native=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/build/aws-lc-sys-33d6dbba370710fa/out -L native=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/build/ring-37f3de2c910507f5/out -L native=/Users/ethanurbanski/arco/.worktrees/codex-delta-primary-cutover/target/debug/build/zstd-sys-bff2b87684f1de04/out` (signal: 6, SIGABRT: process abort signal)
error: used underscore-prefixed binding
   --> crates/arco-flow/src/dag.rs:617:25
    |
617 |         dag.add_edge(a, _c)?;
    |                         ^^
    |
note: binding is defined here
   --> crates/arco-flow/src/dag.rs:614:13
    |
614 |         let _c = dag.add_node("c".into());
    |             ^^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#used_underscore_binding
    = note: `-D clippy::used-underscore-binding` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::used_underscore_binding)]`

error: used underscore-prefixed binding
   --> crates/arco-flow/src/dag.rs:618:25
    |
618 |         dag.add_edge(b, _c)?;
    |                         ^^
    |
note: binding is defined here
   --> crates/arco-flow/src/dag.rs:614:13
    |
614 |         let _c = dag.add_node("c".into());
    |             ^^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#used_underscore_binding

error: redundant closure
   --> crates/arco-flow/src/dag.rs:740:44
    |
740 |         let sorted1 = dag1.toposort_by_key(|v| v.clone())?;
    |                                            ^^^^^^^^^^^^^ help: replace the closure with the method itself: `std::clone::Clone::clone`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#redundant_closure_for_method_calls
    = note: `-D clippy::redundant-closure-for-method-calls` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::redundant_closure_for_method_calls)]`

error: redundant closure
   --> crates/arco-flow/src/dag.rs:741:44
    |
741 |         let sorted2 = dag2.toposort_by_key(|v| v.clone())?;
    |                                            ^^^^^^^^^^^^^ help: replace the closure with the method itself: `std::clone::Clone::clone`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#redundant_closure_for_method_calls

error: redundant closure
   --> crates/arco-flow/src/dag.rs:742:44
    |
742 |         let sorted3 = dag3.toposort_by_key(|v| v.clone())?;
    |                                            ^^^^^^^^^^^^^ help: replace the closure with the method itself: `std::clone::Clone::clone`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#redundant_closure_for_method_calls

error: redundant closure
   --> crates/arco-flow/src/dag.rs:767:42
    |
767 |         let sorted = dag.toposort_by_key(|v| v.clone())?;
    |                                          ^^^^^^^^^^^^^ help: replace the closure with the method itself: `std::clone::Clone::clone`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#redundant_closure_for_method_calls

error: redundant closure
   --> crates/arco-flow/src/dag.rs:788:42
    |
788 |         let result = dag.toposort_by_key(|v| v.clone());
    |                                          ^^^^^^^^^^^^^ help: replace the closure with the method itself: `std::clone::Clone::clone`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#redundant_closure_for_method_calls

error: `panic` should not be present in production code
   --> crates/arco-flow/src/dag.rs:804:18
    |
804 |             _ => panic!("Expected CycleDetected error"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic
    = note: requested on the command line with `-D clippy::panic`

error: redundant closure
   --> crates/arco-flow/src/dag.rs:816:42
    |
816 |         let result = dag.toposort_by_key(|v| v.clone());
    |                                          ^^^^^^^^^^^^^ help: replace the closure with the method itself: `std::clone::Clone::clone`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#redundant_closure_for_method_calls

error: `panic` should not be present in production code
   --> crates/arco-flow/src/dag.rs:823:18
    |
823 |             _ => panic!("Expected CycleDetected error for self-loop"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `expect()` on an `Option` value
   --> crates/arco-flow/src/dispatch/memory.rs:236:21
    |
236 |         let entry = queue.take()?.expect("should have entry");
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used
    = note: requested on the command line with `-D clippy::expect-used`

error: this could be rewritten as `let...else`
   --> crates/arco-flow/src/dispatch/memory.rs:261:9
    |
261 | /         let first_message_id = match result1 {
262 | |             EnqueueResult::Enqueued { message_id } => message_id,
263 | |             _ => return Err(Error::dispatch("expected Enqueued result")),
264 | |         };
    | |__________^ help: consider writing: `let EnqueueResult::Enqueued { message_id: first_message_id } = result1 else { return Err(Error::dispatch("expected Enqueued result")) };`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#manual_let_else
    = note: `-D clippy::manual-let-else` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::manual_let_else)]`

error: `panic` should not be present in production code
   --> crates/arco-flow/src/dispatch/memory.rs:275:13
    |
275 |             panic!("Expected Deduplicated");
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: redundant closure
   --> crates/arco-flow/src/dispatch/memory.rs:381:36
    |
381 |         assert!(results.iter().all(|r| r.is_enqueued()));
    |                                    ^^^^^^^^^^^^^^^^^^^ help: replace the closure with the method itself: `super::super::EnqueueResult::is_enqueued`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#redundant_closure_for_method_calls

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/dispatch/mod.rs:329:78
    |
329 |         let parsed: serde_json::Result<TaskEnvelope> = serde_json::from_str(&json.unwrap());
    |                                                                              ^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used
    = note: requested on the command line with `-D clippy::unwrap-used`

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/leader/memory.rs:240:13
    |
240 |             _ => panic!("Expected NotLeader"),
    |             ^ help: try: `LeadershipResult::Acquired{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants
    = note: `-D clippy::match-wildcard-for-single-variants` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::match_wildcard_for_single_variants)]`

error: `panic` should not be present in production code
   --> crates/arco-flow/src/leader/memory.rs:240:18
    |
240 |             _ => panic!("Expected NotLeader"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/leader/memory.rs:253:22
    |
253 |         let token1 = result1.lease_token().unwrap().to_string();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/leader/memory.rs:258:22
    |
258 |         let token2 = result2.lease_token().unwrap().to_string();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/leader/memory.rs:271:21
    |
271 |         let token = acquire_result.lease_token().unwrap();
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/leader/memory.rs:284:21
    |
284 |         let token = acquire_result.lease_token().unwrap().to_string();
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/leader/memory.rs:300:21
    |
300 |         let token = acquire_result.lease_token().unwrap().to_string();
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/leader/memory.rs:341:21
    |
341 |         let token = acquire_result.lease_token().unwrap();
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:682:13
    |
682 |             self.events.lock().unwrap().push(event.clone());
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: temporary with significant `Drop` can be early dropped
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:771:13
    |
733 |       async fn test_handle_task_started_success() {
    |  _________________________________________________-
734 | |         let ledger = Arc::new(MockLedger::default());
735 | |         let validator = Arc::new(MockTokenValidator::allow_all());
736 | |         let ctx = CallbackContext::new(ledger.clone(), validator, "tenant-1", "workspace-1");
...   |
771 | |         let events = ledger.events.lock().unwrap();
    | |             ^^^^^^
772 | |         assert_eq!(events.len(), 1);
773 | |         assert_eq!(events[0].event_type, "TaskStarted");
774 | |     }
    | |_____- temporary `events` is currently being dropped at the end of its contained scope
    |
    = note: this might lead to unnecessary resource contention
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#significant_drop_tightening
    = note: `-D clippy::significant-drop-tightening` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::significant_drop_tightening)]`
help: drop the temporary after the end of its last usage
   --> /Users/ethanurbanski/.rustup/toolchains/1.85-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/macros/mod.rs:54:10
    |
54  ~         }
55  +         drop(events);
    |

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:767:22
    |
767 |             other => panic!("Expected Ok, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:767:22
    |
767 |             other => panic!("Expected Ok, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
    = note: `-D clippy::uninlined-format-args` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::uninlined_format_args)]`
help: change this to
    |
767 -             other => panic!("Expected Ok, got {:?}", other),
767 +             other => panic!("Expected Ok, got {other:?}"),
    |

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:771:22
    |
771 |         let events = ledger.events.lock().unwrap();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:773:20
    |
773 |         assert_eq!(events[0].event_type, "TaskStarted");
    |                    ^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing
    = note: `-D clippy::indexing-slicing` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::indexing_slicing)]`

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:797:22
    |
797 |             other => panic!("Expected NotFound, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:797:22
    |
797 |             other => panic!("Expected NotFound, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
    |
797 -             other => panic!("Expected NotFound, got {:?}", other),
797 +             other => panic!("Expected NotFound, got {other:?}"),
    |

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:836:22
    |
836 |             other => panic!("Expected Conflict, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:836:22
    |
836 |             other => panic!("Expected Conflict, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
    |
836 -             other => panic!("Expected Conflict, got {:?}", other),
836 +             other => panic!("Expected Conflict, got {other:?}"),
    |

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:877:22
    |
877 |             other => panic!("Expected Conflict, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:877:22
    |
877 |             other => panic!("Expected Conflict, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
    |
877 -             other => panic!("Expected Conflict, got {:?}", other),
877 +             other => panic!("Expected Conflict, got {other:?}"),
    |

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:918:22
    |
918 |             other => panic!("Expected Conflict, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:918:22
    |
918 |             other => panic!("Expected Conflict, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
    |
918 -             other => panic!("Expected Conflict, got {:?}", other),
918 +             other => panic!("Expected Conflict, got {other:?}"),
    |

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:958:22
    |
958 |             other => panic!("Expected Conflict, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:958:22
    |
958 |             other => panic!("Expected Conflict, got {:?}", other),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
    |
958 -             other => panic!("Expected Conflict, got {:?}", other),
958 +             other => panic!("Expected Conflict, got {other:?}"),
    |

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1001:22
     |
1001 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1001:22
     |
1001 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1001 -             other => panic!("Expected Ok, got {:?}", other),
1001 +             other => panic!("Expected Ok, got {other:?}"),
     |

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1042:22
     |
1042 |             other => panic!("Expected Conflict, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1042:22
     |
1042 |             other => panic!("Expected Conflict, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1042 -             other => panic!("Expected Conflict, got {:?}", other),
1042 +             other => panic!("Expected Conflict, got {other:?}"),
     |

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1083:22
     |
1083 |             other => panic!("Expected BadRequest, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1083:22
     |
1083 |             other => panic!("Expected BadRequest, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1083 -             other => panic!("Expected BadRequest, got {:?}", other),
1083 +             other => panic!("Expected BadRequest, got {other:?}"),
     |

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1125:22
     |
1125 |             other => panic!("Expected Gone, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1125:22
     |
1125 |             other => panic!("Expected Gone, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1125 -             other => panic!("Expected Gone, got {:?}", other),
1125 +             other => panic!("Expected Gone, got {other:?}"),
     |

error: temporary with significant `Drop` can be early dropped
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1167:13
     |
1130 |       async fn test_handle_heartbeat_sets_server_timestamp() {
     |  ____________________________________________________________-
1131 | |         let ledger = Arc::new(MockLedger::default());
1132 | |         let validator = Arc::new(MockTokenValidator::allow_all());
1133 | |         let ctx = CallbackContext::new(ledger.clone(), validator, "tenant-1", "workspace-1");
...    |
1167 | |         let events = ledger.events.lock().unwrap();
     | |             ^^^^^^
...    |
1175 | |     }
     | |_____- temporary `events` is currently being dropped at the end of its contained scope
     |
     = note: this might lead to unnecessary resource contention
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#significant_drop_tightening
help: drop the temporary after the end of its last usage
    -->  /Users/ethanurbanski/.rustup/toolchains/1.85-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/macros/mod.rs:54:10
     |
54   ~         }
55   +             drop(events);
     |

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1164:22
     |
1164 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1164:22
     |
1164 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1164 -             other => panic!("Expected Ok, got {:?}", other),
1164 +             other => panic!("Expected Ok, got {other:?}"),
     |

error: used `unwrap()` on a `Result` value
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1167:22
     |
1167 |         let events = ledger.events.lock().unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1169:78
     |
1169 |         if let OrchestrationEventData::TaskHeartbeat { heartbeat_at, .. } = &events[0].data {
     |                                                                              ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1170:32
     |
1170 |             let heartbeat_at = heartbeat_at.expect("heartbeat_at should be set");
     |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1171:38
     |
1171 |             assert_eq!(heartbeat_at, events[0].timestamp);
     |                                      ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1173:13
     |
1173 |             panic!("Expected TaskHeartbeat event");
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1224:22
     |
1224 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1224:22
     |
1224 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1224 -             other => panic!("Expected Ok, got {:?}", other),
1224 +             other => panic!("Expected Ok, got {other:?}"),
     |

error: used `unwrap()` on a `Result` value
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1228:22
     |
1228 |         let events = ledger.events.lock().unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1230:20
     |
1230 |         assert_eq!(events[0].event_type, "TaskFinished");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1236:14
     |
1236 |         } = &events[0].data
     |              ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1242:13
     |
1242 |             panic!("Expected TaskFinished event");
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1287:22
     |
1287 |             other => panic!("Expected Conflict, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1287:22
     |
1287 |             other => panic!("Expected Conflict, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1287 -             other => panic!("Expected Conflict, got {:?}", other),
1287 +             other => panic!("Expected Conflict, got {other:?}"),
     |

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1338:22
     |
1338 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1338:22
     |
1338 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1338 -             other => panic!("Expected Ok, got {:?}", other),
1338 +             other => panic!("Expected Ok, got {other:?}"),
     |

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1394:22
     |
1394 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1394:22
     |
1394 |             other => panic!("Expected Ok, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1394 -             other => panic!("Expected Ok, got {:?}", other),
1394 +             other => panic!("Expected Ok, got {other:?}"),
     |

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1419:22
     |
1419 |             other => panic!("Expected Unauthorized, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: variables can be used directly in the `format!` string
    --> crates/arco-flow/src/orchestration/callbacks/handlers.rs:1419:22
     |
1419 |             other => panic!("Expected Unauthorized, got {:?}", other),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
     |
1419 -             other => panic!("Expected Unauthorized, got {:?}", other),
1419 +             other => panic!("Expected Unauthorized, got {other:?}"),
     |

error: used `expect()` on a `Result` value
   --> crates/arco-flow/src/orchestration/callbacks/types.rs:409:20
    |
409 |         let json = serde_json::to_string(&request).expect("serialize");
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-flow/src/orchestration/callbacks/types.rs:419:41
    |
419 |         let request: HeartbeatRequest = serde_json::from_str(json).expect("deserialize");
    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-flow/src/orchestration/callbacks/types.rs:455:20
    |
455 |         let json = serde_json::to_string(&request).expect("serialize");
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-flow/src/orchestration/callbacks/types.rs:481:20
    |
481 |         let json = serde_json::to_string(&request).expect("serialize");
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3197:23
     |
3197 |         let extract = state.tasks.get(&("run1".into(), "extract".into())).unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3202:25
     |
3202 |           let transform = state
     |  _________________________^
3203 | |             .tasks
3204 | |             .get(&("run1".into(), "transform".into()))
3205 | |             .unwrap();
     | |_____________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3210:20
     |
3210 |         let load = state.tasks.get(&("run1".into(), "load".into())).unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3237:19
     |
3237 |         let run = state.runs.get("run1").unwrap();
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3319:29
     |
3319 |         let b_after_first = state.tasks.get(&("run1".into(), "B".into())).unwrap();
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3333:27
     |
3333 |         let b_after_dup = state.tasks.get(&("run1".into(), "B".into())).unwrap();
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3364:31
     |
3364 |         let run_after_first = state.runs.get("run1").unwrap();
     |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3376:29
     |
3376 |         let run_after_dup = state.runs.get("run1").unwrap();
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3402:13
     |
3402 | /             state
3403 | |                 .tasks
3404 | |                 .get(&("run1".into(), "extract".into()))
3405 | |                 .unwrap()
     | |_________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3414:13
     |
3414 | /             state
3415 | |                 .tasks
3416 | |                 .get(&("run1".into(), "extract".into()))
3417 | |                 .unwrap()
     | |_________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3422:13
     |
3422 | /             state
3423 | |                 .tasks
3424 | |                 .get(&("run1".into(), "extract".into()))
3425 | |                 .unwrap()
     | |_________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3440:20
     |
3440 |         let task = state.tasks.get(&("run1".into(), "extract".into())).unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3466:20
     |
3466 |         let task = state.tasks.get(&("run1".into(), "extract".into())).unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3521:13
     |
3521 |             state.tasks.get(&("run1".into(), "A".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3527:13
     |
3527 |             state.tasks.get(&("run1".into(), "B".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3533:13
     |
3533 |             state.tasks.get(&("run1".into(), "C".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3538:23
     |
3538 |           let ab_edge = state
     |  _______________________^
3539 | |             .dep_satisfaction
3540 | |             .get(&("run1".into(), "A".into(), "B".into()))
3541 | |             .unwrap();
     | |_____________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3545:23
     |
3545 |           let bc_edge = state
     |  _______________________^
3546 | |             .dep_satisfaction
3547 | |             .get(&("run1".into(), "B".into(), "C".into()))
3548 | |             .unwrap();
     | |_____________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3590:13
     |
3590 |             state.tasks.get(&("run1".into(), "A".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3594:13
     |
3594 |             state.tasks.get(&("run1".into(), "B".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3598:19
     |
3598 |         let run = state.runs.get("run1").unwrap();
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3604:23
     |
3604 |           let ab_edge = state
     |  _______________________^
3605 | |             .dep_satisfaction
3606 | |             .get(&("run1".into(), "A".into(), "B".into()))
3607 | |             .unwrap();
     | |_____________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: redundant clone
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3664:52
     |
3664 |         let merged = merge_task_rows(vec![delta_row.clone(), base_row]).unwrap();
     |                                                    ^^^^^^^^ help: remove this
     |
note: this value is dropped without further use
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3664:43
     |
3664 |         let merged = merge_task_rows(vec![delta_row.clone(), base_row]).unwrap();
     |                                           ^^^^^^^^^
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#redundant_clone
     = note: `-D clippy::redundant-clone` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::redundant_clone)]`

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3664:22
     |
3664 |         let merged = merge_task_rows(vec![delta_row.clone(), base_row]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3673:23
     |
3673 |         let merged2 = merge_task_rows(vec![base_row2, delta_row2]).unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3683:22
     |
3683 |         let merged = merge_task_rows(vec![row1, row2]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3697:22
     |
3697 |         let merged = merge_task_rows(vec![row1, row2]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3710:22
     |
3710 |         let merged = merge_task_rows(vec![row]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3721:22
     |
3721 |         let merged = merge_task_rows(vec![base, delta1, delta2]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3789:20
     |
3789 |         let json = serde_json::to_string(&row).unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3793:41
     |
3793 |         let parsed: DispatchOutboxRow = serde_json::from_str(&json).unwrap();
     |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3812:19
     |
3812 |         let row = state.dispatch_outbox.get(&dispatch_id).expect("outbox row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3830:19
     |
3830 |         let row = state.dispatch_outbox.get(&dispatch_id).expect("outbox row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3848:19
     |
3848 |         let row = state.dispatch_outbox.get(&dispatch_id).expect("outbox row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3852:42
     |
3852 |     /// P0 regression test: out-of-order DispatchEnqueued followed by DispatchRequested
     |                                          ^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
     = note: `-D clippy::doc-markdown` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::doc_markdown)]`
help: try
     |
3852 |     /// P0 regression test: out-of-order `DispatchEnqueued` followed by DispatchRequested
     |                                          ~~~~~~~~~~~~~~~~~~

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3852:71
     |
3852 |     /// P0 regression test: out-of-order DispatchEnqueued followed by DispatchRequested
     |                                                                       ^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
3852 |     /// P0 regression test: out-of-order DispatchEnqueued followed by `DispatchRequested`
     |                                                                       ~~~~~~~~~~~~~~~~~~~

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3853:23
     |
3853 |     /// must populate attempt_id (critical for worker concurrency guard).
     |                       ^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
3853 |     /// must populate `attempt_id` (critical for worker concurrency guard).
     |                       ~~~~~~~~~~~~

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3866:19
     |
3866 |         let row = state.dispatch_outbox.get(&dispatch_id).expect("outbox row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3887:19
     |
3887 |         let row = state.dispatch_outbox.get(&dispatch_id).expect("outbox row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3925:20
     |
3925 |         let task = state.tasks.get(&("run1".into(), "extract".into())).unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3929:19
     |
3929 |         let row = state.dispatch_outbox.get(&dispatch_id).expect("outbox row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3937:19
     |
3937 |     /// Test that parse_timer_id correctly extracts timer type and fire epoch.
     |                   ^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
3937 |     /// Test that `parse_timer_id` correctly extracts timer type and fire epoch.
     |                   ~~~~~~~~~~~~~~~~

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3941:22
     |
3941 |         let parsed = TimerRow::parse_timer_id("timer:retry:run1:extract:1:1705320000").unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3949:22
     |
3949 |         let parsed = TimerRow::parse_timer_id("timer:heartbeat:run1:extract:1:1705320000").unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3957:22
     |
3957 |         let parsed = TimerRow::parse_timer_id("timer:cron:daily-etl:1705320000").unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3965:22
     |
3965 |         let parsed = TimerRow::parse_timer_id("timer:sla:run1:extract:1:1705320000").unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3977:42
     |
3977 |     /// P1 regression test: out-of-order TimerEnqueued followed by TimerRequested
     |                                          ^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
3977 |     /// P1 regression test: out-of-order `TimerEnqueued` followed by TimerRequested
     |                                          ~~~~~~~~~~~~~~~

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3977:68
     |
3977 |     /// P1 regression test: out-of-order TimerEnqueued followed by TimerRequested
     |                                                                    ^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
3977 |     /// P1 regression test: out-of-order TimerEnqueued followed by `TimerRequested`
     |                                                                    ~~~~~~~~~~~~~~~~

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3978:60
     |
3978 |     /// must create a timer row and then fill in canonical fire_at.
     |                                                            ^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
3978 |     /// must create a timer row and then fill in canonical `fire_at`.
     |                                                            ~~~~~~~~~

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:3998:19
     |
3998 |         let row = state.timers.get(&timer_id).expect("timer row should exist");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4006:33
     |
4006 |         let canonical_fire_at = DateTime::from_timestamp(fire_epoch + 30, 0).unwrap(); // Slightly different
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4013:19
     |
4013 |         let row = state.timers.get(&timer_id).expect("timer row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4041:19
     |
4041 |         let row = state.timers.get(&timer_id).expect("timer row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4056:23
     |
4056 |         let fire_at = DateTime::from_timestamp(fire_epoch, 0).unwrap();
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4063:19
     |
4063 |         let row = state.timers.get(&timer_id).expect("timer row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4078:19
     |
4078 |         let row = state.timers.get(&timer_id).expect("timer row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4123:20
     |
4123 |         let json = serde_json::to_string(&row).unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4127:32
     |
4127 |         let parsed: TimerRow = serde_json::from_str(&json).unwrap();
     |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4142:19
     |
4142 |         let row = state.timers.get(&timer_id).expect("timer row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4151:19
     |
4151 |         let row = state.timers.get(&timer_id).expect("timer row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4177:22
     |
4177 |         let merged = merge_dispatch_outbox_rows(vec![row1, row2]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4202:22
     |
4202 |         let merged = merge_dispatch_outbox_rows(vec![row1, row2]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4228:22
     |
4228 |         let merged = merge_timer_rows(vec![row1, row2]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4242:22
     |
4242 |             fire_at: DateTime::from_timestamp(1705320000, 0).unwrap(),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4249:22
     |
4249 |             fire_at: DateTime::from_timestamp(1705320030, 0).unwrap(),
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4253:22
     |
4253 |         let merged = merge_timer_rows(vec![row1, row2]).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4368:13
     |
4368 |             state.tasks.get(&("run1".into(), "A".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4372:13
     |
4372 |             state.tasks.get(&("run1".into(), "B".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4376:13
     |
4376 |             state.tasks.get(&("run1".into(), "C".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4385:13
     |
4385 |             state.tasks.get(&("run1".into(), "A".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4389:13
     |
4389 |             state.tasks.get(&("run1".into(), "B".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4393:13
     |
4393 |             state.tasks.get(&("run1".into(), "C".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4398:19
     |
4398 |         let run = state.runs.get("run1").unwrap();
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4406:76
     |
4406 |     /// P0: Running tasks should NOT be immediately cancelled - they check cancel_requested on heartbeat.
     |                                                                            ^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
4406 |     /// P0: Running tasks should NOT be immediately cancelled - they check `cancel_requested` on heartbeat.
     |                                                                            ~~~~~~~~~~~~~~~~~~

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4438:13
     |
4438 |             state.tasks.get(&("run1".into(), "A".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4447:13
     |
4447 |             state.tasks.get(&("run1".into(), "A".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4453:13
     |
4453 |             state.tasks.get(&("run1".into(), "B".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4458:19
     |
4458 |         let run = state.runs.get("run1").unwrap();
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4506:13
     |
4506 |             state.tasks.get(&("run1".into(), "B".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4515:13
     |
4515 |             state.tasks.get(&("run1".into(), "A".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4521:13
     |
4521 |             state.tasks.get(&("run1".into(), "B".into())).unwrap().state,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4526:19
     |
4526 |         let run = state.runs.get("run1").unwrap();
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4577:30
     |
4577 |         let schedule_state = state.schedule_state.get("daily-etl").unwrap();
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4586:20
     |
4586 |         let tick = state.schedule_ticks.get(&tick_id).unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4629:29
     |
4629 |           let first_version = state
     |  _____________________________^
4630 | |             .schedule_ticks
4631 | |             .get(&tick_id)
4632 | |             .unwrap()
     | |_____________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4652:13
     |
4652 |             state.schedule_ticks.get(&tick_id).unwrap().row_version,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4672:30
     |
4672 |         let schedule_state = state.schedule_state.get("daily-etl").unwrap();
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4677:20
     |
4677 |         let tick = state.schedule_ticks.values().next().unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4697:30
     |
4697 |         let schedule_state = state.schedule_state.get("daily-etl").unwrap();
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4701:20
     |
4701 |         let tick = state.schedule_ticks.values().next().unwrap();
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4728:30
     |
4728 |         let schedule_state = state.schedule_state.get("daily-etl").unwrap();
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4807:24
     |
4807 |           let backfill = state
     |  ________________________^
4808 | |             .backfills
4809 | |             .get("bf_001")
4810 | |             .expect("backfill should exist");
     | |____________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4825:21
     |
4825 |           let chunk = state
     |  _____________________^
4826 | |             .backfill_chunks
4827 | |             .get("bf_002:0")
4828 | |             .expect("chunk should exist");
     | |_________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4832:24
     |
4832 |           let backfill = state
     |  ________________________^
4833 | |             .backfills
4834 | |             .get("bf_002")
4835 | |             .expect("backfill should exist");
     | |____________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4852:24
     |
4852 |           let backfill = state
     |  ________________________^
4853 | |             .backfills
4854 | |             .get("bf_003")
4855 | |             .expect("backfill should exist");
     | |____________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4873:24
     |
4873 |           let backfill = state
     |  ________________________^
4874 | |             .backfills
4875 | |             .get("bf_004")
4876 | |             .expect("backfill should exist");
     | |____________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4925:28
     |
4925 |         let sensor_state = state.sensor_state.get("01HQ123SENSORXYZ").unwrap();
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: this could be rewritten as `let...else`
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4933:9
     |
4933 | /         let eval_id = match &event.data {
4934 | |             OrchestrationEventData::SensorEvaluated { eval_id, .. } => eval_id,
4935 | |             _ => unreachable!("expected SensorEvaluated"),
4936 | |         };
     | |__________^ help: consider writing: `let OrchestrationEventData::SensorEvaluated { eval_id .. } = &event.data else { unreachable!("expected SensorEvaluated") };`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#manual_let_else

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4937:24
     |
4937 |         let eval_row = state.sensor_evals.get(eval_id).unwrap();
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:4967:12
     |
4967 |     /// If expected_state_version doesn't match, the stale eval is dropped.
     |            ^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
4967 |     /// If `expected_state_version` doesn't match, the stale eval is dropped.
     |            ~~~~~~~~~~~~~~~~~~~~~~~~

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5002:28
     |
5002 |         let sensor_state = state.sensor_state.get("01HQ456POLLSENSOR").unwrap();
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: this could be rewritten as `let...else`
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5013:9
     |
5013 | /         let eval_id = match &event.data {
5014 | |             OrchestrationEventData::SensorEvaluated { eval_id, .. } => eval_id,
5015 | |             _ => unreachable!("expected SensorEvaluated"),
5016 | |         };
     | |__________^ help: consider writing: `let OrchestrationEventData::SensorEvaluated { eval_id .. } = &event.data else { unreachable!("expected SensorEvaluated") };`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#manual_let_else

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5017:24
     |
5017 |         let eval_row = state.sensor_evals.get(eval_id).unwrap();
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: this could be rewritten as `let...else`
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5054:9
     |
5054 | /         let eval_id = match &event.data {
5055 | |             OrchestrationEventData::SensorEvaluated { eval_id, .. } => eval_id,
5056 | |             _ => unreachable!("expected SensorEvaluated"),
5057 | |         };
     | |__________^ help: consider writing: `let OrchestrationEventData::SensorEvaluated { eval_id .. } = &event.data else { unreachable!("expected SensorEvaluated") };`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#manual_let_else

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5070:37
     |
5070 |     /// CAS should accept eval when expected_state_version matches.
     |                                     ^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
5070 |     /// CAS should accept eval when `expected_state_version` matches.
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5105:28
     |
5105 |         let sensor_state = state.sensor_state.get("01HQ456POLLSENSOR").unwrap();
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: item in documentation is missing backticks
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5117:26
     |
5117 |     /// Push sensors (no expected_state_version) should always be accepted.
     |                          ^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
     |
5117 |     /// Push sensors (no `expected_state_version`) should always be accepted.
     |                          ~~~~~~~~~~~~~~~~~~~~~~~~

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5152:28
     |
5152 |         let sensor_state = state.sensor_state.get("01HQ789PUSHSENSOR").unwrap();
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5185:28
     |
5185 |         let sensor_state = state.sensor_state.get("01HQ123ERRORSENSOR").unwrap();
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: this could be rewritten as `let...else`
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5188:9
     |
5188 | /         let eval_id = match &event.data {
5189 | |             OrchestrationEventData::SensorEvaluated { eval_id, .. } => eval_id,
5190 | |             _ => unreachable!("expected SensorEvaluated"),
5191 | |         };
     | |__________^ help: consider writing: `let OrchestrationEventData::SensorEvaluated { eval_id .. } = &event.data else { unreachable!("expected SensorEvaluated") };`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#manual_let_else

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5192:24
     |
5192 |         let eval_row = state.sensor_evals.get(eval_id).unwrap();
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5214:13
     |
5214 | /             state
5215 | |                 .sensor_state
5216 | |                 .get("01HQ123SENSORXYZ")
5217 | |                 .unwrap()
     | |_________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5238:13
     |
5238 | /             state
5239 | |                 .sensor_state
5240 | |                 .get("01HQ123SENSORXYZ")
5241 | |                 .unwrap()
     | |_________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5282:22
     |
5282 |           let status = state
     |  ______________________^
5283 | |             .partition_status
5284 | |             .get(&key)
5285 | |             .expect("partition status should exist");
     | |____________________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5326:22
     |
5326 |           let status = state
     |  ______________________^
5327 | |             .partition_status
5328 | |             .get(&key)
5329 | |             .expect("partition status should exist");
     | |____________________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5378:36
     |
5378 |         let status_after_success = state.partition_status.get(&key).unwrap().clone();
     |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/fold.rs:5410:22
     |
5410 |         let status = state.partition_status.get(&key).unwrap();
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/compactor/manifest.rs:391:20
    |
391 |         let json = serde_json::to_string_pretty(&manifest).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/compactor/manifest.rs:396:45
    |
396 |         let parsed: OrchestrationManifest = serde_json::from_str(&json).unwrap();
    |                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: field assignment outside of initializer for an instance created with Default::default()
   --> crates/arco-flow/src/orchestration/compactor/manifest.rs:404:9
    |
404 |         watermarks.last_processed_at = Utc::now() - Duration::seconds(10);
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
note: consider initializing the variable with `orchestration::compactor::manifest::Watermarks { last_processed_at: Utc::now() - Duration::seconds(10), ..Default::default() }` and removing relevant reassignments
   --> crates/arco-flow/src/orchestration/compactor/manifest.rs:403:9
    |
403 |         let mut watermarks = Watermarks::default();
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#field_reassign_with_default
    = note: `-D clippy::field-reassign-with-default` implied by `-D clippy::all`
    = help: to override `-D clippy::all` add `#[allow(clippy::field_reassign_with_default)]`

error: field assignment outside of initializer for an instance created with Default::default()
   --> crates/arco-flow/src/orchestration/compactor/manifest.rs:433:9
    |
433 |         tables.runs = Some("runs/snapshot-01.parquet".to_string());
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
note: consider initializing the variable with `orchestration::compactor::manifest::TablePaths { runs: Some("runs/snapshot-01.parquet".to_string()), tasks: Some("tasks/snapshot-01.parquet".to_string()), ..Default::default() }` and removing relevant reassignments
   --> crates/arco-flow/src/orchestration/compactor/manifest.rs:432:9
    |
432 |         let mut tables = TablePaths::default();
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#field_reassign_with_default

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/compactor/manifest.rs:491:20
    |
491 |         let json = serde_json::to_string_pretty(&manifest).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3002:21
     |
3002 |         let bytes = write_runs(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3003:22
     |
3003 |         let parsed = read_runs(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3006:20
     |
3006 |         assert_eq!(parsed[0].run_id, "run_01HQXYZ123");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3007:20
     |
3007 |         assert_eq!(parsed[0].state, RunState::Running);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3008:20
     |
3008 |         assert_eq!(parsed[0].run_key, Some("daily-etl:2025-01-15".to_string()));
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3009:20
     |
3009 |         assert_eq!(parsed[0].tasks_total, 5);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3011:13
     |
3011 |             parsed[0].labels.get("team").map(String::as_str),
     |             ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3038:21
     |
3038 |         let bytes = write_partition_status(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3039:22
     |
3039 |         let parsed = read_partition_status(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3042:20
     |
3042 |         assert_eq!(parsed[0].asset_key, "analytics.daily");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3043:20
     |
3043 |         assert_eq!(parsed[0].partition_key, "2025-01-15");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3044:20
     |
3044 |         assert_eq!(parsed[0].last_attempt_outcome, Some(TaskOutcome::Failed));
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3046:13
     |
3046 |             parsed[0].partition_values.get("date").map(String::as_str),
     |             ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3074:21
     |
3074 |         let bytes = write_backfills(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3075:22
     |
3075 |         let parsed = read_backfills(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3078:20
     |
3078 |         assert_eq!(parsed[0].backfill_id, "bf_01");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3079:20
     |
3079 |         assert_eq!(parsed[0].state, BackfillState::Running);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3080:20
     |
3080 |         assert_eq!(parsed[0].chunk_size, 2);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3098:21
     |
3098 |         let bytes = write_backfill_chunks(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3099:22
     |
3099 |         let parsed = read_backfill_chunks(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3102:20
     |
3102 |         assert_eq!(parsed[0].chunk_id, "bf_01:0");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3103:20
     |
3103 |         assert_eq!(parsed[0].state, ChunkState::Planned);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3104:20
     |
3104 |         assert_eq!(parsed[0].run_id.as_deref(), Some("run_01"));
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3124:21
     |
3124 |           let batch = RecordBatch::try_new(
     |  _____________________^
3125 | |             schema.clone(),
3126 | |             vec![
3127 | |                 Arc::new(StringArray::from(vec![Some("run_01")])),
...    |
3141 | |         .expect("record batch");
     | |_______________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3143:21
     |
3143 |         let bytes = write_single_batch(schema, &batch).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3144:22
     |
3144 |         let parsed = read_runs(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3147:17
     |
3147 |         assert!(parsed[0].run_key.is_none());
     |                 ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3148:18
     |
3148 |         assert!(!parsed[0].cancel_requested);
     |                  ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3149:17
     |
3149 |         assert!(parsed[0].labels.is_empty());
     |                 ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3174:21
     |
3174 |         let bytes = write_tasks(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3175:22
     |
3175 |         let parsed = read_tasks(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3178:20
     |
3178 |         assert_eq!(parsed[0].task_key, "extract");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3179:20
     |
3179 |         assert_eq!(parsed[0].state, TaskState::Ready);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3180:20
     |
3180 |         assert_eq!(parsed[0].asset_key.as_deref(), Some("analytics.extract"));
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3181:17
     |
3181 |         assert!(parsed[0].started_at.is_some());
     |                 ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3197:21
     |
3197 |         let bytes = write_dep_satisfaction(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3198:22
     |
3198 |         let parsed = read_dep_satisfaction(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3201:17
     |
3201 |         assert!(parsed[0].satisfied);
     |                 ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3202:20
     |
3202 |         assert_eq!(parsed[0].resolution, Some(DepResolution::Success));
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3220:21
     |
3220 |         let bytes = write_timers(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3221:22
     |
3221 |         let parsed = read_timers(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3224:20
     |
3224 |         assert_eq!(parsed[0].timer_type, TimerType::Retry);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3225:20
     |
3225 |         assert_eq!(parsed[0].state, TimerState::Scheduled);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3243:21
     |
3243 |         let bytes = write_dispatch_outbox(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3244:22
     |
3244 |         let parsed = read_dispatch_outbox(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3247:20
     |
3247 |         assert_eq!(parsed[0].status, DispatchStatus::Created);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3248:20
     |
3248 |         assert_eq!(parsed[0].worker_queue, "default-queue");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3265:21
     |
3265 |         let bytes = write_sensor_state(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3266:22
     |
3266 |         let parsed = read_sensor_state(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3269:20
     |
3269 |         assert_eq!(parsed[0].sensor_id, "sensor-01");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3270:20
     |
3270 |         assert_eq!(parsed[0].status, SensorStatus::Paused);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3271:20
     |
3271 |         assert_eq!(parsed[0].cursor.as_deref(), Some("cursor_v1"));
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3298:21
     |
3298 |         let bytes = write_sensor_evals(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3299:22
     |
3299 |         let parsed = read_sensor_evals(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3302:20
     |
3302 |         assert_eq!(parsed[0].eval_id, "eval-01");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3303:20
     |
3303 |         assert_eq!(parsed[0].expected_state_version, Some(2));
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3304:20
     |
3304 |         assert_eq!(parsed[0].run_requests.len(), 1);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3305:20
     |
3305 |         assert_eq!(parsed[0].status, SensorEvalStatus::Triggered);
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3320:21
     |
3320 |         let bytes = write_idempotency_keys(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3321:22
     |
3321 |         let parsed = read_idempotency_keys(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3325:13
     |
3325 |             parsed[0].idempotency_key,
     |             ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3328:20
     |
3328 |         assert_eq!(parsed[0].event_type, "SensorEvaluated");
     |                    ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3347:21
     |
3347 |         let bytes = write_schedule_definitions(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3348:22
     |
3348 |         let parsed = read_schedule_definitions(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3365:21
     |
3365 |         let bytes = write_schedule_state(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3366:22
     |
3366 |         let parsed = read_schedule_state(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3389:21
     |
3389 |         let bytes = write_schedule_ticks(&rows).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3390:22
     |
3390 |         let parsed = read_schedule_ticks(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3398:21
     |
3398 |           let batch = RecordBatch::try_new(
     |  _____________________^
3399 | |             schema.clone(),
3400 | |             vec![
3401 | |                 Arc::new(StringArray::from(vec![Some("run_01")])),
...    |
3419 | |         .expect("record batch");
     | |_______________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3421:21
     |
3421 |         let bytes = write_single_batch(schema, &batch).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap_err()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3422:19
     |
3422 |         let err = read_runs(&bytes).unwrap_err();
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Ok`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3429:21
     |
3429 |           let batch = RecordBatch::try_new(
     |  _____________________^
3430 | |             schema.clone(),
3431 | |             vec![
3432 | |                 Arc::new(StringArray::from(vec![Some("run_01")])),
...    |
3451 | |         .expect("record batch");
     | |_______________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3453:21
     |
3453 |         let bytes = write_single_batch(schema, &batch).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap_err()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3454:19
     |
3454 |         let err = read_tasks(&bytes).unwrap_err();
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Ok`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3475:21
     |
3475 |           let batch = RecordBatch::try_new(
     |  _____________________^
3476 | |             schema.clone(),
3477 | |             vec![
3478 | |                 Arc::new(StringArray::from(vec![Some("run_01")])),
...    |
3492 | |         .expect("record batch");
     | |_______________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3494:21
     |
3494 |         let bytes = write_single_batch(schema, &batch).expect("write");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3495:22
     |
3495 |         let parsed = read_tasks(&bytes).expect("read");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3498:17
     |
3498 |         assert!(parsed[0].asset_key.is_none());
     |                 ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/parquet_util.rs:3499:17
     |
3499 |         assert!(parsed[0].partition_key.is_none());
     |                 ^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1237:29
     |
1237 |                 Bytes::from(serde_json::to_string(&event1).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1245:29
     |
1245 |                 Bytes::from(serde_json::to_string(&event2).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1259:13
     |
1259 |             serde_json::from_slice(&manifest_data).expect("parse");
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1263:20
     |
1263 |         assert_eq!(manifest.l0_deltas[0].event_range.event_count, 2);
     |                    ^^^^^^^^^^^^^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1282:29
     |
1282 |                 Bytes::from(serde_json::to_string(&event1).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1289:29
     |
1289 |                 Bytes::from(serde_json::to_string(&event2).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: this function has too many lines (191/100)
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1320:11
     |
1320 |       async fn cold_restart_preserves_layer2_backfills_ticks_and_sensors() -> Result<()> {
     |  ___________^
1321 | |         let (_compactor, storage) = create_test_compactor().await?;
1322 | |
1323 | |         let now = Utc::now();
...    |
1534 | |         Ok(())
1535 | |     }
     | |_____^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#too_many_lines
     = note: `-D clippy::too-many-lines` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::too_many_lines)]`

error: adding items after statements is confusing, since items exist from the start of the scope
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1334:9
     |
1334 | /         fn event_with_id(
1335 | |             event_id: &str,
1336 | |             timestamp: DateTime<Utc>,
1337 | |             data: OrchestrationEventData,
...    |
1342 | |             e
1343 | |         }
     | |_________^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#items_after_statements
     = note: `-D clippy::items-after-statements` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::items_after_statements)]`

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1496:33
     |
1496 |                     Bytes::from(serde_json::to_string(event).expect("serialize")),
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1512:20
     |
1512 |         let tick = state.schedule_ticks.get(&tick_id).expect("tick");
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1518:21
     |
1518 |         let chunk = state.backfill_chunks.get(chunk_id).expect("chunk");
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1520:28
     |
1520 |         let sched_run_id = tick.run_id.as_deref().expect("schedule run_id");
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1521:27
     |
1521 |           let sched_index = state
     |  ___________________________^
1522 | |             .run_key_index
1523 | |             .get("sched:1")
1524 | |             .expect("schedule run_key_index");
     | |_____________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1527:25
     |
1527 |         let bf_run_id = chunk.run_id.as_deref().expect("backfill chunk run_id");
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1528:24
     |
1528 |           let bf_index = state
     |  ________________________^
1529 | |             .run_key_index
1530 | |             .get("backfill:bf-01:0")
1531 | |             .expect("backfill run_key_index");
     | |_____________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1552:29
     |
1552 |                 Bytes::from(serde_json::to_string(&event1).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1559:29
     |
1559 |                 Bytes::from(serde_json::to_string(&event2).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1570:13
     |
1570 |             serde_json::from_slice(&manifest_data).expect("parse");
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1603:29
     |
1603 |                 Bytes::from(serde_json::to_string(&event1).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1610:29
     |
1610 |                 Bytes::from(serde_json::to_string(&event2).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1623:29
     |
1623 |                 Bytes::from(serde_json::to_string(&event3).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1632:13
     |
1632 |             serde_json::from_slice(&manifest_data).expect("parse");
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1634:22
     |
1634 |         let latest = manifest.l0_deltas.last().expect("delta");
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1662:29
     |
1662 |                 Bytes::from(serde_json::to_string(&enqueued).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1675:29
     |
1675 |                 Bytes::from(serde_json::to_string(&requested).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1684:19
     |
1684 |         let row = state.dispatch_outbox.get(&dispatch_id).expect("outbox row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1706:29
     |
1706 |                 Bytes::from(serde_json::to_string(&enqueued).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1713:33
     |
1713 |         let canonical_fire_at = DateTime::from_timestamp(fire_epoch + 30, 0).unwrap();
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1720:29
     |
1720 |                 Bytes::from(serde_json::to_string(&requested).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1729:19
     |
1729 |         let row = state.timers.get(&timer_id).expect("timer row");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1745:29
     |
1745 |                 Bytes::from(serde_json::to_string(&manifest).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1751:23
     |
1751 |         let version = version.expect("version");
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1757:29
     |
1757 |                 Bytes::from(serde_json::to_string(&bumped).expect("serialize")),
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap_err()` on a `Result` value
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1762:19
     |
1762 |           let err = compactor
     |  ___________________^
1763 | |             .publish_manifest(&manifest, Some(&version))
1764 | |             .await
1765 | |             .unwrap_err();
     | |_________________________^
     |
     = note: if this value is an `Ok`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: boolean to int conversion using if
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:304:22
    |
304 |             attempt: if state == TaskState::Ready { 0 } else { 1 },
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: replace with from: `u32::from(state != TaskState::Ready)`
    |
    = note: `(state != TaskState::Ready) as u32` or `(state != TaskState::Ready).into()` can also be valid options
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#bool_to_int_with_if
    = note: `-D clippy::bool-to-int-with-if` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::bool_to_int_with_if)]`

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:331:26
    |
331 |             dispatch_id: format!("dispatch:run1:{}:{}", task_key, attempt),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
    |
331 -             dispatch_id: format!("dispatch:run1:{}:{}", task_key, attempt),
331 +             dispatch_id: format!("dispatch:run1:{task_key}:{attempt}"),
    |

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:332:33
    |
332 |             cloud_task_id: Some(format!("d_abc{}", attempt)),
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args
help: change this to
    |
332 -             cloud_task_id: Some(format!("d_abc{}", attempt)),
332 +             cloud_task_id: Some(format!("d_abc{attempt}")),
    |

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:374:16
    |
374 |         match &repairs[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:385:18
    |
385 |             _ => panic!("Expected CreateDispatchOutbox repair"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:480:16
    |
480 |         match &repairs[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:491:18
    |
491 |             _ => panic!("Expected RedispatchStuckTask repair"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:510:16
    |
510 |         match &repairs[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:521:18
    |
521 |             _ => panic!("Expected CreateDispatchOutbox repair"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:545:16
    |
545 |         match &repairs[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:556:18
    |
556 |             _ => panic!("Expected RedispatchStuckTask repair"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/anti_entropy.rs:578:26
    |
578 |         assert!(matches!(repairs[0], Repair::SkippedDueToLag { .. }));
    |                          ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/controllers/backfill.rs:906:25
    |
906 |             let start = NaiveDate::parse_from_str(start, "%Y-%m-%d").unwrap();
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/controllers/backfill.rs:907:23
    |
907 |             let end = NaiveDate::parse_from_str(end, "%Y-%m-%d").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: casting `i64` to `u32` may truncate the value
   --> crates/arco-flow/src/orchestration/controllers/backfill.rs:908:13
    |
908 |             (end - start).num_days() as u32 + 1
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#cast_possible_truncation
    = note: `-D clippy::cast-possible-truncation` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::cast_possible_truncation)]`
help: ... or use `try_from` and handle the error accordingly
    |
908 |             u32::try_from((end - start).num_days()) + 1
    |             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

error: casting `i64` to `u32` may lose the sign of the value
   --> crates/arco-flow/src/orchestration/controllers/backfill.rs:908:13
    |
908 |             (end - start).num_days() as u32 + 1
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#cast_sign_loss
    = note: `-D clippy::cast-sign-loss` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::cast_sign_loss)]`

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/controllers/backfill.rs:919:25
    |
919 |             let start = NaiveDate::parse_from_str(start, "%Y-%m-%d").unwrap();
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/controllers/backfill.rs:920:23
    |
920 |             let end = NaiveDate::parse_from_str(end, "%Y-%m-%d").unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on a `Result` value
   --> crates/arco-flow/src/orchestration/controllers/backfill.rs:984:23
    |
984 |           let preview = controller
    |  _______________________^
985 | |             .preview("analytics.daily", "2025-01-01", "2025-01-31", 10)
986 | |             .expect("preview should succeed");
    | |_____________________________________________^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:998:23
     |
998  |           let preview = controller
     |  _______________________^
999  | |             .preview("analytics.daily", "2025-01-01", "2025-01-10", 0)
1000 | |             .expect("preview should succeed");
     | |_____________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1016:21
     |
1016 |           let event = controller
     |  _____________________^
1017 | |             .create(&CreateBackfillRequest {
1018 | |                 backfill_id: "bf_01HQ123",
1019 | |                 tenant_id: "tenant-abc",
...    |
1027 | |             })
1028 | |             .expect("create should succeed");
     | |____________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1051:13
     |
1051 |             panic!("Expected BackfillCreated event");
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1060:21
     |
1060 |           let event = controller
     |  _____________________^
1061 | |             .create(&CreateBackfillRequest {
1062 | |                 backfill_id: "bf_001",
1063 | |                 tenant_id: "tenant-abc",
...    |
1071 | |             })
1072 | |             .expect("create should succeed");
     | |____________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: avoid using `collect()` when not needed
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1147:14
     |
1147 |             .collect();
     |              ^^^^^^^
1148 |
1149 |         assert_eq!(chunk_events.len(), 2, "Should plan max_concurrent chunks");
     |                    ------------------ the iterator could be used here instead
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#needless_collect
     = note: `-D clippy::needless-collect` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::needless_collect)]`
help: take the original Iterator's count instead of collecting it and finding the length
     |
1144 ~         
1145 |
1146 ~         assert_eq!(events
1147 +             .iter()
1148 ~             .filter(|e| matches!(&e.data, OrchestrationEventData::BackfillChunkPlanned { .. })).count(), 2, "Should plan max_concurrent chunks");
     |

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1165:27
     |
1165 |           let chunk_event = events
     |  ___________________________^
1166 | |             .iter()
1167 | |             .find(|e| matches!(&e.data, OrchestrationEventData::BackfillChunkPlanned { .. }))
1168 | |             .expect("Should have chunk event");
     | |______________________________________________^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1220:21
     |
1220 |           let event = controller
     |  _____________________^
1221 | |             .pause("bf_001", &current_state, "tenant-abc", "workspace-prod")
1222 | |             .expect("pause should succeed");
     | |___________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1235:13
     |
1235 |             panic!("Expected BackfillStateChanged event");
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1293:21
     |
1293 |           let event = controller
     |  _____________________^
1294 | |             .resume("bf_001", &current, "tenant-abc", "workspace-prod")
1295 | |             .expect("resume should succeed");
     | |____________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1320:21
     |
1320 |           let event = controller
     |  _____________________^
1321 | |             .cancel("bf_001", &current, "tenant-abc", "workspace-prod")
1322 | |             .expect("cancel should succeed");
     | |____________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1376:21
     |
1376 |           let event = controller
     |  _____________________^
1377 | |             .retry_failed(
1378 | |                 "bf_002",
1379 | |                 &parent,
...    |
1385 | |             .expect("retry_failed should succeed");
     | |__________________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: `panic` should not be present in production code
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1405:17
     |
1405 |                 panic!("Expected explicit partition selector");
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1436:22
     |
1436 |           let event1 = controller
     |  ______________________^
1437 | |             .retry_failed(
1438 | |                 "bf_002",
1439 | |                 &parent,
...    |
1445 | |             .expect("retry_failed should succeed");
     | |__________________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
    --> crates/arco-flow/src/orchestration/controllers/backfill.rs:1447:22
     |
1447 |           let event2 = controller
     |  ______________________^
1448 | |             .retry_failed(
1449 | |                 "bf_003", // Different ID, same request
1450 | |                 &parent,
...    |
1456 | |             .expect("retry_failed should succeed");
     | |__________________________________________________^
     |
     = note: if this value is an `Err`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:330:13
    |
330 |             _ => panic!("Expected CreateCloudTask action"),
    |             ^ help: try: `DispatchAction::Skip{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:320:16
    |
320 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:330:18
    |
330 |             _ => panic!("Expected CreateCloudTask action"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:355:13
    |
355 |             _ => panic!("Expected Skip action"),
    |             ^ help: try: `DispatchAction::CreateCloudTask{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:347:16
    |
347 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:355:18
    |
355 |             _ => panic!("Expected Skip action"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:376:13
    |
376 |             _ => panic!("Expected Skip action"),
    |             ^ help: try: `DispatchAction::CreateCloudTask{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:372:16
    |
372 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:376:18
    |
376 |             _ => panic!("Expected Skip action"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:398:13
    |
398 |             _ => panic!("Expected Skip action due to compaction lag"),
    |             ^ help: try: `DispatchAction::CreateCloudTask{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:394:16
    |
394 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:398:18
    |
398 |             _ => panic!("Expected Skip action due to compaction lag"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:435:20
    |
435 |         let json = payload.to_json().unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:440:22
    |
440 |         let parsed = DispatchPayload::from_json(&json).unwrap();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:472:17
    |
472 |                 _ => None,
    |                 ^ help: try: `DispatchAction::Skip{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:478:20
    |
478 |         assert_ne!(cloud_ids[0], cloud_ids[1]);
    |                    ^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/dispatcher.rs:478:34
    |
478 |         assert_ne!(cloud_ids[0], cloud_ids[1]);
    |                                  ^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:361:13
    |
361 |             _ => panic!("Expected EmitDispatchRequested action"),
    |             ^ help: try: `ReadyDispatchAction::Skip{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:346:16
    |
346 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:361:18
    |
361 |             _ => panic!("Expected EmitDispatchRequested action"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:414:13
    |
414 |             _ => panic!("Expected Skip action"),
    |             ^ help: try: `ReadyDispatchAction::EmitDispatchRequested{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:410:16
    |
410 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:414:18
    |
414 |             _ => panic!("Expected Skip action"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:438:23
    |
438 |             matches!(&actions[0], ReadyDispatchAction::Skip { reason, .. } if reason.contains("Created"))
    |                       ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:460:13
    |
460 |             _ => panic!("Expected Skip action due to compaction lag"),
    |             ^ help: try: `ReadyDispatchAction::EmitDispatchRequested{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:456:16
    |
456 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:460:18
    |
460 |             _ => panic!("Expected Skip action due to compaction lag"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:482:14
    |
482 |             &actions[0],
    |              ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:502:17
    |
502 |         match (&actions1[0], &actions2[0]) {
    |                 ^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:502:31
    |
502 |         match (&actions1[0], &actions2[0]) {
    |                               ^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:521:18
    |
521 |             _ => panic!("Expected EmitDispatchRequested actions"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:545:17
    |
545 |                 _ => None,
    |                 ^ help: try: `ReadyDispatchAction::Skip{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:551:13
    |
551 |             attempt_ids[0], attempt_ids[1],
    |             ^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:551:29
    |
551 |             attempt_ids[0], attempt_ids[1],
    |                             ^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:599:15
    |
599 |         match event_data.unwrap() {
    |               ^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/ready_dispatch.rs:612:18
    |
612 |             _ => panic!("Expected DispatchRequested event data"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/schedule.rs:667:22
    |
667 |         let event = &events[0];
    |                      ^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/schedule.rs:678:13
    |
678 |             panic!("Expected ScheduleTicked event");
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: using `clone` on type `DateTime<Utc>` which implements the `Copy` trait
   --> crates/arco-flow/src/orchestration/controllers/schedule.rs:709:26
    |
709 |                     Some(scheduled_for.clone())
    |                          ^^^^^^^^^^^^^^^^^^^^^ help: try dereferencing it: `*scheduled_for`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#clone_on_copy
    = note: `-D clippy::clone-on-copy` implied by `-D clippy::all`
    = help: to override `-D clippy::all` add `#[allow(clippy::clone_on_copy)]`

error: used `expect()` on an `Option` value
   --> crates/arco-flow/src/orchestration/controllers/schedule.rs:720:24
    |
720 |           let min_tick = scheduled_fors
    |  ________________________^
721 | |             .iter()
722 | |             .min()
723 | |             .expect("expected at least one tick");
    | |_________________________________________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: using `clone` on type `DateTime<Utc>` which implements the `Copy` trait
   --> crates/arco-flow/src/orchestration/controllers/schedule.rs:791:26
    |
791 |                     Some(scheduled_for.clone())
    |                          ^^^^^^^^^^^^^^^^^^^^^ help: try dereferencing it: `*scheduled_for`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#clone_on_copy

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/controllers/schedule.rs:824:17
    |
824 | /                 assert!(
825 | |                     tick_id.starts_with("01HQ123SCHEDXYZ:"),
826 | |                     "tick_id should use schedule_id ULID: {}",
827 | |                     tick_id
828 | |                 );
    | |_________________^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args

error: variables can be used directly in the `format!` string
   --> crates/arco-flow/src/orchestration/controllers/schedule.rs:829:17
    |
829 | /                 assert!(
830 | |                     tick_id.contains(&format!("manual:{epoch}")),
831 | |                     "tick_id should contain epoch: {}",
832 | |                     tick_id
833 | |                 );
    | |_________________^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#uninlined_format_args

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:462:20
    |
462 |         let eval = eval_event.unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `expect()` on an `Option` value
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:483:26
    |
483 |           let eval_event = events
    |  __________________________^
484 | |             .iter()
485 | |             .find(|e| matches!(&e.data, OrchestrationEventData::SensorEvaluated { .. }))
486 | |             .expect("Should have SensorEvaluated event");
    | |________________________________________________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:589:26
    |
589 |           let eval_event = events
    |  __________________________^
590 | |             .iter()
591 | |             .find(|e| matches!(&e.data, OrchestrationEventData::SensorEvaluated { .. }))
592 | |             .expect("Should have SensorEvaluated event");
    | |________________________________________________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:745:26
    |
745 |           let eval_event = events
    |  __________________________^
746 | |             .iter()
747 | |             .find(|e| matches!(&e.data, OrchestrationEventData::SensorEvaluated { .. }))
748 | |             .expect("Should have SensorEvaluated event");
    | |________________________________________________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
   --> crates/arco-flow/src/orchestration/controllers/sensor.rs:789:26
    |
789 |           let eval_event = events
    |  __________________________^
790 | |             .iter()
791 | |             .find(|e| matches!(&e.data, OrchestrationEventData::SensorEvaluated { .. }))
792 | |             .expect("Should have SensorEvaluated event");
    | |________________________________________________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:236:13
    |
236 |             _ => panic!("Expected CreateTimer action"),
    |             ^ help: try: `TimerAction::Skip{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:225:16
    |
225 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:236:18
    |
236 |             _ => panic!("Expected CreateTimer action"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:259:13
    |
259 |             _ => panic!("Expected Skip action"),
    |             ^ help: try: `TimerAction::CreateTimer{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:255:16
    |
255 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:259:18
    |
259 |             _ => panic!("Expected Skip action"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:282:13
    |
282 |             _ => panic!("Expected Skip action"),
    |             ^ help: try: `TimerAction::CreateTimer{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:278:16
    |
278 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:282:18
    |
282 |             _ => panic!("Expected Skip action"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: wildcard matches only a single variant and will also match any future added variants
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:305:13
    |
305 |             _ => panic!("Expected Skip action due to compaction lag"),
    |             ^ help: try: `TimerAction::CreateTimer{ .. }`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#match_wildcard_for_single_variants

error: indexing may panic
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:301:16
    |
301 |         match &actions[0] {
    |                ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/timer.rs:305:18
    |
305 |             _ => panic!("Expected Skip action due to compaction lag"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/timer_handlers.rs:562:18
    |
562 |             _ => panic!("Expected IncrementAttempt actions"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/controllers/timer_handlers.rs:598:18
    |
598 |             _ => panic!("Expected IncrementAttempt actions"),
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/events/automation_events.rs:137:20
    |
137 |         let json = serde_json::to_string(&triggered).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/events/automation_events.rs:143:20
    |
143 |         let json = serde_json::to_string(&skipped).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/events/automation_events.rs:153:20
    |
153 |         let json = serde_json::to_string(&push).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/events/automation_events.rs:160:20
    |
160 |         let json = serde_json::to_string(&poll).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/events/automation_events.rs:168:20
    |
168 |         let json = serde_json::to_string(&triggered).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/events/automation_events.rs:174:20
    |
174 |         let json = serde_json::to_string(&error).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/events/backfill_events.rs:150:20
    |
150 |         let json = serde_json::to_string(&range).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on a `Result` value
   --> crates/arco-flow/src/orchestration/events/backfill_events.rs:157:20
    |
157 |         let json = serde_json::to_string(&explicit).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: item in documentation is missing backticks
   --> crates/arco-flow/src/orchestration/events/mod.rs:179:40
    |
179 |     /// Creates an event with explicit event_id for deterministic testing.
    |                                        ^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#doc_markdown
help: try
    |
179 |     /// Creates an event with explicit `event_id` for deterministic testing.
    |                                        ~~~~~~~~~~

error: case-sensitive file extension comparison
   --> crates/arco-flow/src/orchestration/run_key.rs:329:17
    |
329 |         assert!(path.ends_with(".json"));
    |                 ^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using a case-insensitive comparison instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#case_sensitive_file_extension_comparisons
    = note: `-D clippy::case-sensitive-file-extension-comparisons` implied by `-D warnings`
    = help: to override `-D warnings` add `#[allow(clippy::case_sensitive_file_extension_comparisons)]`
help: use std::path::Path
    |
329 ~         assert!(std::path::Path::new(&path)
330 +             .extension()
331 ~             .map_or(false, |ext| ext.eq_ignore_ascii_case("json")));
    |

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/orchestration/run_key.rs:331:25
    |
331 |           let hash_part = path
    |  _________________________^
332 | |             .strip_prefix("run_keys/")
333 | |             .unwrap()
334 | |             .strip_suffix(".json")
335 | |             .unwrap();
    | |_____________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/orchestration/run_key.rs:331:25
    |
331 |           let hash_part = path
    |  _________________________^
332 | |             .strip_prefix("run_keys/")
333 | |             .unwrap()
    | |_____________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/run_key.rs:377:17
    |
377 |                 panic!("expected AlreadyExists, got Reserved");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/run_key.rs:380:17
    |
380 |                 panic!("expected AlreadyExists, got FingerprintMismatch");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `expect_err()` on a `Result` value
   --> crates/arco-flow/src/orchestration/run_key.rs:493:19
    |
493 |           let err = reserve_run_key(&storage, &reservation2, FingerprintPolicy::lenient())
    |  ___________________^
494 | |             .await
495 | |             .expect_err("expected error");
    | |_________________________________________^
    |
    = note: if this value is an `Ok`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/orchestration/run_key.rs:519:25
    |
519 |         let retrieved = get_reservation(&storage, "test-key").await?.unwrap();
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/run_key.rs:564:17
    |
564 |                 panic!("expected FingerprintMismatch, got AlreadyExists");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/run_key.rs:567:17
    |
567 |                 panic!("expected FingerprintMismatch, got Reserved");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/run_key.rs:599:17
    |
599 |                 panic!("expected AlreadyExists, got FingerprintMismatch");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/run_key.rs:602:17
    |
602 |                 panic!("expected AlreadyExists, got Reserved");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/orchestration/run_key.rs:639:22
    |
639 |         let cutoff = DateTime::from_timestamp(1_700_000_000, 0).unwrap();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/orchestration/run_key.rs:666:22
    |
666 |         let cutoff = DateTime::from_timestamp(1_700_000_000, 0).unwrap();
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/run_key.rs:690:17
    |
690 |                 panic!("expected FingerprintMismatch, got AlreadyExists");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
   --> crates/arco-flow/src/orchestration/run_key.rs:693:17
    |
693 |                 panic!("expected FingerprintMismatch, got Reserved");
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `expect()` on a `Result` value
   --> crates/arco-flow/src/orchestration/run_key.rs:712:20
    |
712 |         let json = serde_json::to_string(&reservation).expect("serialize");
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-flow/src/orchestration/run_key.rs:713:41
    |
713 |         let parsed: RunKeyReservation = serde_json::from_str(&json).expect("deserialize");
    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on a `Result` value
   --> crates/arco-flow/src/outbox.rs:173:20
    |
173 |         let ulid = Ulid::from_string("01ARZ3NDEKTSV4RRFFQ69G5FAV").expect("valid ULID");
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is an `Err`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: indexing may panic
   --> crates/arco-flow/src/plan.rs:665:20
    |
665 |         assert_eq!(plan.tasks[0].stage, 0);
    |                    ^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: this function has too many lines (108/100)
   --> crates/arco-flow/src/plan.rs:839:5
    |
839 | /     fn plan_task_order_is_stable_across_insertion_order() -> Result<()> {
840 | |         let task_a = TaskId::generate();
841 | |         let task_b = TaskId::generate();
842 | |         let task_c = TaskId::generate();
...   |
956 | |         Ok(())
957 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#too_many_lines

error: an inclusive range would be more readable
    --> crates/arco-flow/src/plan.rs:1079:18
     |
1079 |         for _ in 0..(MAX_TASKS_PER_PLAN + 1) {
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use: `0..=MAX_TASKS_PER_PLAN`
     |
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#range_plus_one
     = note: `-D clippy::range-plus-one` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::range_plus_one)]`

error: `panic` should not be present in production code
   --> crates/arco-flow/src/quota/memory.rs:344:13
    |
344 |             panic!("Expected Denied");
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: `panic` should not be present in production code
   --> crates/arco-flow/src/quota/memory.rs:360:13
    |
360 |             panic!("Expected Denied");
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#panic

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/quota/memory.rs:412:21
    |
412 |         let quota = quota.unwrap();
    |                     ^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
    --> crates/arco-flow/src/scheduler.rs:1225:20
     |
1225 |         assert_eq!(outbox.events()[0].sequence, Some(1));
     |                    ^^^^^^^^^^^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/scheduler.rs:1266:20
     |
1266 |         assert_eq!(ready[0].task_id, task_a);
     |                    ^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/scheduler.rs:1367:20
     |
1367 |         assert_eq!(ready[0].task_id, task_high);
     |                    ^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
    --> crates/arco-flow/src/scheduler.rs:1368:20
     |
1368 |         assert_eq!(ready[1].task_id, task_low);
     |                    ^^^^^^^^
     |
     = help: consider using `.get(n)` or `.get_mut(n)` instead
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:326:20
    |
326 |         assert_eq!(retrieved.unwrap().id, run_id);
    |                    ^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:336:23
    |
336 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:354:23
    |
354 |         let updated = store.get_run(&run_id).await?.unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:355:20
    |
355 |         let task = updated.get_task(&task_id).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:371:23
    |
371 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:403:23
    |
403 |         let updated = store.get_run(&run_id).await?.unwrap();
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:404:20
    |
404 |         let task = updated.get_task(&task_id).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:417:23
    |
417 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:441:23
    |
441 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:464:19
    |
464 |         let run = store.get_run(&run_id).await?.unwrap();
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:465:20
    |
465 |         let task = run.get_task(&task_id).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:495:23
    |
495 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:504:20
    |
504 |         assert_eq!(pending[0].task_id, task_id);
    |                    ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:539:23
    |
539 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:542:20
    |
542 |         let task = run.get_task_mut(&task_id).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:552:20
    |
552 |         assert_eq!(zombies[0], task_id);
    |                    ^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:568:23
    |
568 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:571:20
    |
571 |         let task = run.get_task_mut(&task_id).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:590:23
    |
590 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:593:20
    |
593 |         let task = run.get_task_mut(&task_id).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:602:20
    |
602 |         assert_eq!(eligible[0], task_id);
    |                    ^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:612:23
    |
612 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:615:20
    |
615 |         let task = run.get_task_mut(&task_id).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:633:23
    |
633 |         let task_id = run.task_executions[0].task_id;
    |                       ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:636:20
    |
636 |         let task = run.get_task_mut(&task_id).unwrap();
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:643:20
    |
643 |         assert_eq!(by_tenant[0].0, "test-tenant");
    |                    ^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:644:20
    |
644 |         assert_eq!(by_tenant[0].1.len(), 1);
    |                    ^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `unwrap()` on an `Option` value
   --> crates/arco-flow/src/store/memory.rs:657:13
    |
657 | /             run.get_task_mut(&task_id)
658 | |                 .unwrap()
    | |_________________________^
    |
    = note: if this value is `None`, it will panic
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unwrap_used

error: indexing may panic
   --> crates/arco-flow/src/store/memory.rs:666:38
    |
666 |         let ready_ids: Vec<TaskId> = by_tenant[0].1.iter().map(|t| t.task_id).collect();
    |                                      ^^^^^^^^^^^^
    |
    = help: consider using `.get(n)` or `.get_mut(n)` instead
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/task.rs:1020:19
     |
1020 |         let now = exec.dispatched_at.expect("dispatched_at should be set");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: used `expect()` on an `Option` value
    --> crates/arco-flow/src/task.rs:1048:19
     |
1048 |         let now = exec.last_heartbeat.expect("last_heartbeat should be set");
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
     = note: if this value is `None`, it will panic
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#expect_used

error: unused `async` for function with no await statements
    --> crates/arco-flow/src/orchestration/compactor/service.rs:1072:5
     |
1072 | /     async fn create_test_compactor() -> Result<(MicroCompactor, ScopedStorage)> {
1073 | |         let backend = Arc::new(MemoryBackend::new());
1074 | |         let storage = ScopedStorage::new(backend, "tenant", "workspace")?;
1075 | |         let compactor = MicroCompactor::new(storage.clone());
1076 | |         Ok((compactor, storage))
1077 | |     }
     | |_____^
     |
     = help: consider removing the `async` from this function
     = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#unused_async
     = note: `-D clippy::unused-async` implied by `-D warnings`
     = help: to override `-D warnings` add `#[allow(clippy::unused_async)]`

error: could not compile `arco-flow` (lib test) due to 508 previous errors

Exit code: 101

