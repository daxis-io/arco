Session search log
Date: 2025-12-30
Scope: catalog-mvp audit evidence sweep (architecture alignment, tests, signed URL paths)

Command: rg -n "Parquet-first|Parquet-first Metadata|signed URLs|Query engines read directly via signed URLs" /Users/ethanurbanski/arco/docs/adr/adr-001-parquet-metadata.md /Users/ethanurbanski/arco/README.md /Users/ethanurbanski/arco/docs/guide/src/introduction.md
Output:
/Users/ethanurbanski/arco/README.md:21:| **Metadata as files** | Parquet-first storage for catalog and operational metadata, optimized for direct SQL access |
/Users/ethanurbanski/arco/README.md:22:| **Query-native reads** | Browser and server query engines read metadata directly via signed URLs, eliminating always-on infrastructure |
/Users/ethanurbanski/arco/docs/guide/src/introduction.md:7:- **Metadata as files**: Parquet-first storage for catalog and operational metadata
/Users/ethanurbanski/arco/docs/guide/src/introduction.md:8:- **Query-native reads**: Direct SQL access via signed URLs
/Users/ethanurbanski/arco/docs/adr/adr-001-parquet-metadata.md:1:# ADR-001: Parquet-first Metadata Storage
/Users/ethanurbanski/arco/docs/adr/adr-001-parquet-metadata.md:13:- Query engines read directly via signed URLs

Command: rg -n "Root Manifest|Root manifest|Domain manifests|Four Domain Manifests|root.manifest.json" /Users/ethanurbanski/arco/docs/adr/adr-003-manifest-domains.md /Users/ethanurbanski/arco/docs/adr/adr-005-storage-layout.md /Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md
Output:
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:7:- **Root manifest**: Exists and points to valid domain manifests
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:8:- **Domain manifests**: Catalog, lineage, executions, search manifests are well-formed
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:17:| Root manifest | Entry point exists | Critical |
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:18:| Domain manifests | All 4 domains readable | Critical |
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:113:  Root manifest... [ok]
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:114:  Domain manifests... [ok]
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:127:#### 1. Root Manifest Missing
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:130:Root manifest... [FAIL]
/Users/ethanurbanski/arco/docs/runbooks/storage-integrity-verification.md:132:  - Root manifest: Failed to read 'manifests/root.manifest.json'
/Users/ethanurbanski/arco/docs/adr/adr-005-storage-layout.md:22:│   ├── root.manifest.json           # Entry point - points to domain manifests
/Users/ethanurbanski/arco/docs/adr/adr-005-storage-layout.md:94:assert_eq!(CatalogPaths::ROOT_MANIFEST, "manifests/root.manifest.json");
/Users/ethanurbanski/arco/docs/adr/adr-003-manifest-domains.md:17:### Four Domain Manifests
/Users/ethanurbanski/arco/docs/adr/adr-003-manifest-domains.md:28:### Root Manifest as Entry Point
/Users/ethanurbanski/arco/docs/adr/adr-003-manifest-domains.md:30:The `root.manifest.json` is the **only stable contract** for external readers:
/Users/ethanurbanski/arco/docs/adr/adr-003-manifest-domains.md:49:1. **Reader compatibility**: Root manifest loader accepts both old and new domain names

Command: rg -n "Tier-1|Tier 1|Tier-2|Tier 2" /Users/ethanurbanski/arco/docs/adr/adr-018-tier1-write-path.md /Users/ethanurbanski/arco/docs/adr/adr-004-event-envelope.md /Users/ethanurbanski/arco/README.md /Users/ethanurbanski/arco/CLAUDE.md
Output:
/Users/ethanurbanski/arco/CLAUDE.md:95:- Two-tier consistency model (Tier 1: strong DDL, Tier 2: eventual events)
/Users/ethanurbanski/arco/README.md:37:│   └── arco-compactor/  # Compaction binary for Tier 2 events
/Users/ethanurbanski/arco/README.md:89:| `arco-compactor` | Compaction binary for Tier 2 event consolidation | Alpha |
/Users/ethanurbanski/arco/docs/adr/adr-004-event-envelope.md:7:Tier-2 (eventual consistency) operations write events to an append-only ledger before compaction. These events must:
/Users/ethanurbanski/arco/docs/adr/adr-004-event-envelope.md:19:All Tier-2 events use this envelope structure:
/Users/ethanurbanski/arco/docs/adr/adr-004-event-envelope.md:22:/// Canonical envelope for all Tier-2 ledger events.
/Users/ethanurbanski/arco/docs/adr/adr-018-tier1-write-path.md:1:# ADR-018: Tier-1 Write Path Architecture
/Users/ethanurbanski/arco/docs/adr/adr-018-tier1-write-path.md:28:Tier-1 (DDL) operations become:
/Users/ethanurbanski/arco/docs/adr/adr-018-tier1-write-path.md:44:For Tier-1 strong consistency, API triggers compaction synchronously:
/Users/ethanurbanski/arco/docs/adr/adr-018-tier1-write-path.md:102:- Added latency for Tier-1 DDL operations (~100-500ms for RPC round-trip)
/Users/ethanurbanski/arco/docs/adr/adr-018-tier1-write-path.md:128:├── snapshots/   # Tier-1 Parquet snapshots (Compactor writes)
/Users/ethanurbanski/arco/docs/adr/adr-018-tier1-write-path.md:129:├── state/       # Tier-2 compacted state (Compactor writes)
/Users/ethanurbanski/arco/docs/adr/adr-018-tier1-write-path.md:133:├── sequence/    # Tier-2 position counters (API writes via CAS)

Command: rg -n "browser_e2e|api_integration|tier2" /Users/ethanurbanski/arco/crates/arco-api/tests /Users/ethanurbanski/arco/crates/arco-test-utils/tests /Users/ethanurbanski/arco/crates/arco-catalog/tests
Output:
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:205:async fn tier2_append_compact_read_loop() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:288:async fn tier2_out_of_order_processing() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:367:async fn tier2_idempotent_events() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:429:async fn tier2_incremental_compaction() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:497:async fn tier2_crash_recovery() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:592:async fn tier2_concurrent_compactor_race() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:650:async fn tier2_workspace_isolation() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:718:async fn tier2_derived_current_pointers() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:798:async fn tier2_snapshot_does_not_shrink_across_compactions() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:884:async fn tier2_compactor_sole_parquet_writer() {
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:994:    // This is essentially the same as tier2_compactor_sole_parquet_writer
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:1285:// NOTE: CAS conflict handling is covered by `tier2_concurrent_compactor_race`,

Command: rg --files -g 'concurrent_writers.rs' -g 'schema_contracts.rs' -g 'failure_injection.rs' -g 'tier2.rs' -g 'browser_e2e.rs' -g 'api_integration.rs' -g 'openapi_contract.rs' -g 'iam_smoke.rs' /Users/ethanurbanski/arco/crates
Output:
/Users/ethanurbanski/arco/crates/arco-integration-tests/tests/iam_smoke.rs
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs
/Users/ethanurbanski/arco/crates/arco-catalog/tests/schema_contracts.rs
/Users/ethanurbanski/arco/crates/arco-catalog/tests/failure_injection.rs
/Users/ethanurbanski/arco/crates/arco-catalog/tests/concurrent_writers.rs
/Users/ethanurbanski/arco/crates/arco-api/tests/api_integration.rs
/Users/ethanurbanski/arco/crates/arco-api/tests/browser_e2e.rs
/Users/ethanurbanski/arco/crates/arco-api/tests/openapi_contract.rs

Command: rg --files -g '*.py' /Users/ethanurbanski/arco/python/arco/tests
Output:
/Users/ethanurbanski/arco/python/arco/tests/__init__.py
/Users/ethanurbanski/arco/python/arco/tests/integration/test_cli_api.py
/Users/ethanurbanski/arco/python/arco/tests/integration/test_e2e.py
/Users/ethanurbanski/arco/python/arco/tests/integration/__init__.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_decorator.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_cli_config.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_serialization.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_cli_commands.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_check.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_introspection.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_partition.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_manifest_builder.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_contract.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_ids.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_discovery.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_property.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_lockfile.py
/Users/ethanurbanski/arco/python/arco/tests/unit/__init__.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_asset_types.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_cli_main.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_registry.py
/Users/ethanurbanski/arco/python/arco/tests/unit/test_manifest_model.py

Tool grep: pattern "signed URL|signed URLs|signed-url|signed_url" include "*.md" path /Users/ethanurbanski/arco/docs
Output:
/Users/ethanurbanski/arco/docs/runbooks/metrics-catalog.md:230: #### `arco_signed_urls_issued_total`
/Users/ethanurbanski/arco/docs/runbooks/metrics-catalog.md:236: #### `arco_signed_url_expiry_seconds`
/Users/ethanurbanski/arco/docs/runbooks/metrics-catalog.md:241: Requested signed URL expiry times.
/Users/ethanurbanski/arco/docs/guide/src/introduction.md:8: - **Query-native reads**: Direct SQL access via signed URLs
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:71: - Missing API surface (REST) and clients, missing browser signed URL minting and DuckDB-WASM read path.
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:97: | Tenant storage layout abstraction (GCS/S3/local via abstraction) | Storage trait + Memory backend: `crates/arco-core/src/storage.rs`; scoped prefix enforcement: `crates/arco-core/src/scoped_storage.rs` | Partial | `cargo test` ✅; scoped isolation tests pass | Only in-memory backend; no production backend wiring to GCS/S3; “signed_url” is mock for MemoryBackend | Implement real backends via `object_store` and/or provider SDKs; add integration tests behind feature flags (P0/P1 depending on launch target) |
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:122: ### Milestone 4 — Browser read path (DuckDB-WASM) + signed URL API
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:127: | TS SDK + DuckDB-WASM demo | None | Missing | Repo scan | No proof that browser-direct reads work | Add minimal web demo + SDK; validate against real object storage CORS & signed URLs (P1) |
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:267: - **Rate limiting / quotas** absent: high risk of denial-of-wallet for signed URL minting and ledger writes once APIs exist.
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:272: - **Secrets handling** (P0/P1): use a secret manager (not env vars in plain text) for signing keys or cloud credentials; ensure logs never include signed URL query params; define rotation playbook.
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:301: - No e2e tests covering “catalog registry → Parquet snapshot → browser read via signed URL” because the product surface is not implemented.
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:316: 1) **Missing API + signed URL + browser read path** (Critical × Certain)
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:328: - Implement signed URL mint endpoint with strict allowlist + TTL + tenant scoping; validate with a minimal browser query demo. (Owner: API/Web) (Effort: 3–7d)
/Users/ethanurbanski/arco/docs/audits/2025-12-17-part2-catalog-mvp-audit.md:345: - Tier-1 e2e: REST write (create namespace/table/lineage edge) → Tier-1 snapshot published → server query (DataFusion) reads Parquet → browser fetches signed URLs and DuckDB-WASM queries Parquet.
/Users/ethanurbanski/arco/docs/audits/2025-12-30-prod-readiness/findings/gate-2-findings.md:122: - DuckDB read path validated via browser E2E (signed URL + `read_parquet`): `crates/arco-api/tests/browser_e2e.rs:251`
/Users/ethanurbanski/arco/docs/adr/adr-019-existence-privacy.md:84: Every signed URL includes correlation metadata:
/Users/ethanurbanski/arco/docs/adr/adr-019-existence-privacy.md:186: 1. Add correlation ID to signed URL generation
/Users/ethanurbanski/arco/docs/adr/adr-001-parquet-metadata.md:13: - Query engines read directly via signed URLs

Tool grep: pattern "Two-tier|two-tier|Tier-1|Tier-2" include "README.md" path /Users/ethanurbanski/arco
Output:
/Users/ethanurbanski/arco/README.md:24: | **Two-tier consistency** | Strong consistency for DDL; eventual consistency for high-volume operational facts |
/Users/ethanurbanski/arco/docs/adr/README.md:31: | [018](adr-018-tier1-write-path.md) | Tier-1 write path architecture | Accepted |

Tool grep: pattern "Two-tier|two-tier|Tier-1|Tier-2" include "CLAUDE.md" path /Users/ethanurbanski/arco
Output:
/Users/ethanurbanski/arco/CLAUDE.md:95: - Two-tier consistency model (Tier 1: strong DDL, Tier 2: eventual events)

Tool ast_grep_search: pattern "$OBJ.signed_url($$$)" (rust, /Users/ethanurbanski/arco/crates)
Output:
/Users/ethanurbanski/arco/crates/arco-test-utils/tests/tier2.rs:200:9
/Users/ethanurbanski/arco/crates/arco-core/src/storage.rs:454:19
/Users/ethanurbanski/arco/crates/arco-core/src/storage.rs:744:19
/Users/ethanurbanski/arco/crates/arco-core/src/scoped_storage.rs:560:9
/Users/ethanurbanski/arco/crates/arco-flow/tests/orchestration_correctness_tests.rs:484:9
/Users/ethanurbanski/arco/crates/arco-catalog/src/tier1_writer.rs:573:13
/Users/ethanurbanski/arco/crates/arco-catalog/tests/failure_injection.rs:170:9
/Users/ethanurbanski/arco/crates/arco-catalog/src/compactor.rs:1422:13

Tool ast_grep_search: pattern "$OBJ.signed_urls($$$)" (rust, /Users/ethanurbanski/arco/crates)
Output:
No matches
