[2026-02-15T20:19:17Z] STEP=impl-head-handler-status
COMMAND: nl -ba crates/arco-iceberg/src/routes/namespaces.rs | sed -n '277,331p'
   277	/// Head namespace.
   278	#[utoipa::path(
   279	    head,
   280	    path = "/v1/{prefix}/namespaces/{namespace}",
   281	    params(
   282	        ("prefix" = String, Path, description = "Catalog prefix"),
   283	        ("namespace" = String, Path, description = "Namespace name")
   284	    ),
   285	    responses(
   286	        (status = 204, description = "Namespace exists"),
   287	        (status = 404, description = "Not found", body = crate::error::IcebergErrorResponse),
   288	        (status = 400, description = "Bad request", body = crate::error::IcebergErrorResponse),
   289	        (status = 401, description = "Unauthorized", body = crate::error::IcebergErrorResponse),
   290	        (status = 403, description = "Forbidden", body = crate::error::IcebergErrorResponse),
   291	        (status = 419, description = "Authentication timeout", body = crate::error::IcebergErrorResponse),
   292	        (status = 503, description = "Service unavailable", body = crate::error::IcebergErrorResponse),
   293	        (status = 500, description = "Internal error", body = crate::error::IcebergErrorResponse),
   294	    ),
   295	    tag = "Namespaces"
   296	)]
   297	#[instrument(skip_all, fields(request_id = %ctx.request_id, tenant = %ctx.tenant, workspace = %ctx.workspace, prefix = %path.prefix, namespace = %path.namespace))]
   298	async fn head_namespace(
   299	    Extension(ctx): Extension<IcebergRequestContext>,
   300	    State(state): State<IcebergState>,
   301	    Path(path): Path<NamespacePath>,
   302	) -> IcebergResult<Response> {
   303	    ensure_prefix(&path.prefix, &state.config)?;
   304	    let separator = state.config.namespace_separator_decoded();
   305	    let namespace_ident = parse_namespace(&path.namespace, &separator)?;
   306	    let namespace_name = join_namespace(&namespace_ident, &separator)?;
   307	
   308	    let storage = ctx.scoped_storage(Arc::clone(&state.storage))?;
   309	    let reader = CatalogReader::new(storage);
   310	
   311	    let exists = reader
   312	        .get_namespace(&namespace_name)
   313	        .await
   314	        .map_err(IcebergError::from)?
   315	        .is_some();
   316	
   317	    let status = if exists {
   318	        StatusCode::NO_CONTENT
   319	    } else {
   320	        StatusCode::NOT_FOUND
   321	    };
   322	
   323	    Response::builder()
   324	        .status(status)
   325	        .body(axum::body::Body::empty())
   326	        .map_err(|e| IcebergError::Internal {
   327	            message: format!("Failed to build response: {e}"),
   328	        })
   329	}
   330	
   331	/// Delete namespace.
